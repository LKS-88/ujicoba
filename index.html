<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - SISTEM BANTUAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --login-gradient: linear-gradient(135deg, #0d47a1, #00695c, #ff8f00);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
            border-left: 4px solid var(--primary-color);
        }
        
        .developer-logo {
            max-width: 120px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Welcome Splash Screen */
        .welcome-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash-content {
            text-align: center;
            max-width: 600px;
            padding: 30px;
        }
        
        .welcome-splash-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .welcome-splash-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .welcome-splash-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .welcome-splash-countdown {
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .welcome-splash-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .welcome-splash-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Login Modal Styles */
        .login-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .login-header {
            background: var(--login-gradient);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }

        .login-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin: 5px 0 0;
        }

        .login-body {
            padding: 25px;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-label {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .login-form-label i {
            margin-right: 10px;
            color: var(--dark-blue);
        }

        .login-form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .login-form-control:focus {
            border-color: var(--dark-blue);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
        }

        .login-input-group-text {
            background: var(--light-blue);
            border: 2px solid #ddd;
            border-left: none;
        }

        .btn-login {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 105, 92, 0.4);
        }

        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-security-notice {
            text-align: center;
            margin-top: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        .login-attempts-count {
            text-align: center;
            font-size: 0.9rem;
            color: #ff8f00;
            font-weight: 500;
            margin-top: 5px;
        }

        .login-blocked-message {
            text-align: center;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            color: #dc3545;
            font-weight: 500;
        }

        .login-countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .login-developer-info {
            background: var(--light-blue);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .login-developer-logo {
            max-width: 180px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .login-developer-contact a {
            color: var(--dark-blue);
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px 0;
        }

        .login-developer-contact a:hover {
            color: var(--primary-color);
            text-decoration: underline;
            transform: translateY(-2px);
        }

        .login-copyright {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Animations */
        @keyframes login-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .login-shake {
            animation: login-shake 0.6s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Login particle background */
        #login-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1040; /* Higher than modal backdrop */
            display: none;
        }

        /* Link Google Drive dalam tabel */
        .drive-link {
            color: #0d47a1;
            text-decoration: none;
            cursor: pointer;
        }

        .drive-link:hover {
            text-decoration: underline;
        }

        /* Modal untuk menambah link */
        .link-modal .modal-dialog {
            max-width: 600px;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal fade login-modal" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="login-header">
                    <div class="login-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h2 class="login-title">AUTHENTICATION REQUIRED</h2>
                    <p class="login-subtitle">Masukkan Kode Keamanan untuk Mengakses Aplikasi</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="mb-3 login-form-group">
                            <label class="form-label login-form-label">
                                <i class="fas fa-key"></i> Kode Keamanan
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control login-form-control" id="securityCode" placeholder="Masukkan kode akses aplikasi">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text text-danger login-attempts-count" id="attemptsCount"></div>
                        </div>
                        <button type="submit" class="btn btn-login" id="loginButton">
                            <span class="login-button-text">Masuk ke Aplikasi</span>
                            <span class="spinner-border spinner-border-sm d-none" id="loginSpinner"></span>
                        </button>
                    </form>
                    
                    <div class="login-blocked-message d-none" id="blockedMessage">
                        <i class="fas fa-ban me-2"></i>
                        <span id="blockedText">Terlalu banyak percobaan gagal. Silakan coba lagi dalam </span>
                        <span class="login-countdown" id="countdown">30</span> detik.
                    </div>
                    
                    <div class="login-security-notice">
                        <i class="fas fa-info-circle me-2"></i>
                        Hubungi Administrator untuk mendapatkan kode akses
                    </div>
                    
                    <div class="login-developer-info">
                        <h5 class="mb-3">Developer Information</h5>
                        <div class="login-developer-contact">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                    
                    <div class="login-copyright">
                        &copy; 2025 Lentera karya Situbondo
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login particle background -->
    <div id="login-particles"></div>
    
    <!-- Welcome Splash Screen -->
    <div class="welcome-splash" id="welcomeSplash">
        <button class="welcome-splash-close" id="closeSplash">
            <i class="fas fa-times"></i>
        </button>
        <div class="welcome-splash-content">
            <div class="welcome-splash-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="welcome-splash-title">SISTEM BANTUAN BARJAS</h1>
            <p class="welcome-splash-message">
                Aplikasi Sistem Bantuan BARJAS merupakan platform terpadu yang dirancang untuk mentransformasi pendataan, penyaluran, 
                dan monitoring program bantuan pemerintah. Aplikasi ini kami ciptakan untuk mendorong efisiensi, akurasi, 
                dan transparansi dalam pengelolaan bantuan, guna mempercepat penyerapan dan meningkatkan akuntabilitas.
            </p>
            <div class="welcome-splash-countdown" id="splashCountdown">
                Membuka aplikasi dalam <span id="countdownTimer">5</span> detik...
            </div>
        </div>
    </div>
    
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <div class="app-container animate-fadeIn">
        <div class="app-header">
            <div class="app-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="app-title">BARJAS</h1>
            <p class="app-subtitle">Sistem Bantuan Terpadu</p>
            <p class="app-subtitle" id="institutionName">Nama Instansi/Lembaga</p>
            <div class="watermark">v2.1.0</div>
        </div>
        
        <div class="row g-0">
            <!-- Sidebar Navigation -->
            <div class="col-md-3 col-lg-2 p-4 bg-light" id="sidebar">
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-bs-target="dashboard">
                            <span class="feature-icon"><i class="fas fa-home"></i></span>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-bs-target="inputData">
                            <span class="feature-icon"><i class="fas fa-pen-to-square"></i></span>
                            Input Data Bantuan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-bs-target="dataTable">
                            <span class="feature-icon"><i class="fas fa-table"></i></span>
                            Tabel Data
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-bs-target="settings">
                            <span class="feature-icon"><i class="fas fa-cog"></i></span>
                            Pengaturan
                        </a>
                    </li>
                    <li class="nav-item mt-4">
                        <a href="#" class="nav-link text-danger" id="logoutBtn">
                            <span class="feature-icon"><i class="fas fa-sign-out-alt"></i></span>
                            Keluar
                        </a>
                    </li>
                </ul>
                
                <div class="developer-info mt-5">
                    <h6 class="text-center mb-3">Developer Information</h6>
                    <div class="text-center mb-3">
                        <img src="https://raw.githubusercontent.com/LKS-88/ujicoba/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" alt="Developer Logo" class="developer-logo">
                    </div>
                    <div class="developer-contact text-center">
                        <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                        <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                    </div>
                </div>
            </div>
            
            <!-- Main Content Area -->
            <div class="col-md-9 col-lg-10 p-5" id="mainContent">
                <!-- Dashboard Section -->
                <div class="content-section" id="dashboard">
                    <h3 class="section-title">Dashboard</h3>
                    
                    <div class="row">
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-users fa-2x text-primary"></i>
                                </div>
                                <div class="stats-number" id="totalPenerima">0</div>
                                <div class="stats-label">Total Penerima Bantuan</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-box-open fa-2x text-success"></i>
                                </div>
                                <div class="stats-number" id="totalBarang">0</div>
                                <div class="stats-label">Jenis Barang Disalurkan</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-calendar-alt fa-2x text-warning"></i>
                                </div>
                                <div class="stats-number" id="tahunAktif">2025</div>
                                <div class="stats-label">Tahun Anggaran Aktif</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-chart-line fa-2x text-info"></i>
                                </div>
                                <div class="stats-number" id="totalNilai">0</div>
                                <div class="stats-label">Total Nilai Bantuan</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-chart-bar me-2"></i> Statistik Bantuan per Tahun
                                </div>
                                <div class="card-body">
                                    <canvas id="yearlyChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-chart-pie me-2"></i> Distribusi Bantuan
                                </div>
                                <div class="card-body">
                                    <canvas id="distributionChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-history me-2"></i> Data Bantuan Terbaru
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover data-table" id="recentDataTable">
                                            <thead>
                                                <tr>
                                                    <th>No</th>
                                                    <th>Nama Penerima</th>
                                                    <th>NIK</th>
                                                    <th>Kelompok</th>
                                                    <th>Barang</th>
                                                    <th>Tahun</th>
                                                    <th>WhatsApp</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Data akan diisi oleh JavaScript -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Input Data Section -->
                <div class="content-section d-none" id="inputData">
                    <h3 class="section-title">Input Data Bantuan</h3>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-pen-to-square me-2"></i> Formulir Input Data
                        </div>
                        <div class="card-body">
                            <form id="dataForm">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">
                                            <i class="fas fa-user"></i> Nama Penerima
                                        </label>
                                        <input type="text" class="form-control" id="namaPenerima" placeholder="Masukkan nama lengkap" required>
                                        <div class="error-message" id="namaError">Nama harus diisi dan minimal 3 karakter</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">
                                            <i class="fas fa-id-card"></i> NIK KTP (16 digit)
                                        </label>
                                        <input type="text" class="form-control" id="nikKtp" maxlength="16" placeholder="Masukkan NIK KTP 16 digit" required>
                                        <div class="error-message" id="nikError">NIK harus 16 digit angka</div>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">
                                            <i class="fas fa-users"></i> Nama Kelompok
                                        </label>
                                        <input type="text" class="form-control" id="namaKelompok" placeholder="Masukkan nama kelompok" required>
                                        <div class="error-message" id="kelompokError">Nama kelompok harus diisi</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">
                                            <i class="fas fa-box"></i> Nama Barang Bantuan
                                        </label>
                                        <input type="text" class="form-control" id="namaBarang" placeholder="Masukkan nama barang bantuan" required>
                                        <div class="error-message" id="barangError">Nama barang harus diisi</div>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">
                                            <i class="fas fa-calendar"></i> Tahun Anggaran
                                        </label>
                                        <select class="form-select" id="tahunAnggaran" required>
                                            <option value="" selected disabled>Pilih Tahun Anggaran</option>
                                            <!-- Tahun akan diisi oleh JavaScript -->
                                        </select>
                                        <div class="error-message" id="tahunError">Tahun anggaran harus dipilih</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">
                                            <i class="fab fa-whatsapp"></i> Nomor WhatsApp
                                        </label>
                                        <input type="text" class="form-control" id="nomorWhatsapp" placeholder="Masukkan nomor WhatsApp (08...)" required>
                                        <div class="error-message" id="whatsappError">Nomor WhatsApp harus diisi dengan format yang benar</div>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-12">
                                        <label class="form-label">
                                            <i class="fas fa-link"></i> Link Google Drive (opsional)
                                        </label>
                                        <input type="url" class="form-control" id="linkGoogleDrive" placeholder="Masukkan link Google Drive (jika ada)">
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-end mt-4">
                                    <button type="reset" class="btn btn-light me-3">
                                        <i class="fas fa-undo me-1"></i> Reset
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-1"></i> Simpan Data
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Data Table Section -->
                <div class="content-section d-none" id="dataTable">
                    <h3 class="section-title">Tabel Data Bantuan</h3>
                    
                    <div class="filter-section">
                        <div class="row">
                            <div class="col-md-4">
                                <label class="form-label">
                                    <i class="fas fa-filter"></i> Filter Tahun
                                </label>
                                <select class="form-select" id="filterTahun">
                                    <option value="all">Semua Tahun</option>
                                    <!-- Tahun akan diisi oleh JavaScript -->
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">
                                    <i class="fas fa-search"></i> Cari Data
                                </label>
                                <input type="text" class="form-control" id="searchInput" placeholder="Cari berdasarkan nama, NIK, atau kelompok...">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">
                                    <i class="fas fa-download"></i> Ekspor Data
                                </label>
                                <div class="d-flex">
                                    <button class="btn btn-success me-2 w-100" id="exportExcelBtn">
                                        <i class="fas fa-file-excel me-1"></i> Excel
                                    </button>
                                    <button class="btn btn-danger w-100" id="exportPdfBtn">
                                        <i class="fas fa-file-pdf me-1"></i> PDF
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-hover data-table" id="mainDataTable">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Nama Penerima</th>
                                    <th>NIK</th>
                                    <th>Kelompok</th>
                                    <th>Barang</th>
                                    <th>Tahun</th>
                                    <th>WhatsApp</th>
                                    <th>Link</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <div class="fw-bold" id="tableInfo">Menampilkan 0 data</div>
                        <nav>
                            <ul class="pagination justify-content-end" id="pagination">
                                <!-- Pagination akan diisi oleh JavaScript -->
                            </ul>
                        </nav>
                    </div>
                </div>
                
                <!-- Settings Section -->
                <div class="content-section d-none" id="settings">
                    <h3 class="section-title">Pengaturan Aplikasi</h3>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-building me-2"></i> Pengaturan Instansi
                                </div>
                                <div class="card-body">
                                    <form id="institutionForm">
                                        <div class="mb-3">
                                            <label class="form-label">
                                                <i class="fas fa-signature"></i> Nama Instansi/Lembaga
                                            </label>
                                            <input type="text" class="form-control" id="institutionNameInput" placeholder="Masukkan nama instansi/lembaga">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">
                                                <i class="fas fa-image"></i> Link Logo Instansi
                                            </label>
                                            <input type="url" class="form-control" id="institutionLogoUrl" value="https://raw.githubusercontent.com/LKS-88/ujicoba/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" placeholder="Masukkan URL logo instansi">
                                        </div>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save me-1"></i> Simpan Pengaturan
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-database me-2"></i> Kelola Data
                                </div>
                                <div class="card-body">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-warning mb-2" id="backupDataBtn">
                                            <i class="fas fa-download me-1"></i> Backup Data
                                        </button>
                                        <button class="btn btn-info mb-2" id="restoreDataBtn">
                                            <i class="fas fa-upload me-1"></i> Restore Data
                                        </button>
                                        <input type="file" class="d-none" id="restoreFileInput" accept=".json">
                                        <button class="btn btn-danger" id="resetDataBtn">
                                            <i class="fas fa-trash me-1"></i> Hapus Semua Data
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mt-4">
                                <div class="card-header">
                                    <i class="fas fa-info-circle me-2"></i> Informasi Aplikasi
                                </div>
                                <div class="card-body">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Versi Aplikasi
                                            <span class="badge bg-primary">v2.1.0</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Total Data Tersimpan
                                            <span class="badge bg-success" id="totalDataCount">0</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Tanggal Install
                                            <span class="badge bg-info" id="installDate">-</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Browser
                                            <span class="badge bg-warning text-dark" id="browserInfo">-</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            &copy; 2025 Aplikasi BARJAS - Sistem Bantuan Terpadu. Hak Cipta Dilindungi.
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <div class="floating-action-btn" id="scrollTopBtn">
        <i class="fas fa-arrow-up"></i>
    </div>
    
    <!-- Notification Toast -->
    <div class="toast notification-toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true" id="successToast">
        <div class="d-flex">
            <div class="toast-body">
                <i class="fas fa-check-circle me-2"></i>
                <span id="toastMessage">Operasi berhasil dilakukan</span>
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
    
    <div class="toast notification-toast align-items-center text-white bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true" id="errorToast">
        <div class="d-flex">
            <div class="toast-body">
                <i class="fas fa-exclamation-circle me-2"></i>
                <span id="errorToastMessage">Terjadi kesalahan</span>
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmationModalTitle">Konfirmasi</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="confirmationModalBody">
                    Apakah Anda yakin ingin melanjutkan?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="confirmationModalConfirm">Ya, Lanjutkan</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Link Modal -->
    <div class="modal fade link-modal" id="linkModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tambah/Ubah Link</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Link Google Drive</label>
                        <input type="url" class="form-control" id="modalLinkInput" placeholder="Masukkan link Google Drive">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="saveLinkBtn">Simpan</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Print Header (hidden until printing) -->
    <div class="print-header d-none">
        <div class="print-title">LAPORAN DATA BANTUAN</div>
        <div class="print-subtitle" id="printInstitutionName">Nama Instansi/Lembaga</div>
        <div class="print-date" id="printDate"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.id.min.js"></script>
    
    <script>
        // Konfigurasi aplikasi
        const APP_CONFIG = {
            appName: "BARJAS",
            appVersion: "2.1.0",
            securityCode: "BARJAS2025", // Kode keamanan default
            maxLoginAttempts: 3,
            loginBlockTime: 30, // dalam detik
            itemsPerPage: 10,
            defaultLogoUrl: "https://raw.githubusercontent.com/LKS-88/ujicoba/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png"
        };
        
        // State aplikasi
        let appState = {
            isLoggedIn: false,
            loginAttempts: 0,
            isBlocked: false,
            blockTimeRemaining: 0,
            blockTimer: null,
            currentData: [],
            currentPage: 1,
            currentEditId: null,
            currentLinkEditId: null,
            charts: {},
            sortField: 'tanggalInput',
            sortDirection: 'desc'
        };
        
        // Elemen DOM
        const domElements = {
            loginModal: document.getElementById('loginModal'),
            loginForm: document.getElementById('loginForm'),
            securityCode: document.getElementById('securityCode'),
            loginButton: document.getElementById('loginButton'),
            loginSpinner: document.getElementById('loginSpinner'),
            attemptsCount: document.getElementById('attemptsCount'),
            blockedMessage: document.getElementById('blockedMessage'),
            blockText: document.getElementById('blockText'),
            countdown: document.getElementById('countdown'),
            welcomeSplash: document.getElementById('welcomeSplash'),
            closeSplash: document.getElementById('closeSplash'),
            splashCountdown: document.getElementById('splashCountdown'),
            countdownTimer: document.getElementById('countdownTimer'),
            mobileMenuBtn: document.getElementById('mobileMenuBtn'),
            sidebar: document.getElementById('sidebar'),
            sidebarOverlay: document.getElementById('sidebarOverlay'),
            mainContent: document.getElementById('mainContent'),
            contentSections: document.querySelectorAll('.content-section'),
            navLinks: document.querySelectorAll('.nav-link'),
            logoutBtn: document.getElementById('logoutBtn'),
            scrollTopBtn: document.getElementById('scrollTopBtn'),
            successToast: document.getElementById('successToast'),
            errorToast: document.getElementById('errorToast'),
            toastMessage: document.getElementById('toastMessage'),
            errorToastMessage: document.getElementById('errorToastMessage'),
            confirmationModal: document.getElementById('confirmationModal'),
            confirmationModalTitle: document.getElementById('confirmationModalTitle'),
            confirmationModalBody: document.getElementById('confirmationModalBody'),
            confirmationModalConfirm: document.getElementById('confirmationModalConfirm'),
            dataForm: document.getElementById('dataForm'),
            institutionForm: document.getElementById('institutionForm'),
            institutionName: document.getElementById('institutionName'),
            institutionNameInput: document.getElementById('institutionNameInput'),
            institutionLogoUrl: document.getElementById('institutionLogoUrl'),
            mainDataTable: document.getElementById('mainDataTable'),
            recentDataTable: document.getElementById('recentDataTable'),
            filterTahun: document.getElementById('filterTahun'),
            searchInput: document.getElementById('searchInput'),
            exportExcelBtn: document.getElementById('exportExcelBtn'),
            exportPdfBtn: document.getElementById('exportPdfBtn'),
            backupDataBtn: document.getElementById('backupDataBtn'),
            restoreDataBtn: document.getElementById('restoreDataBtn'),
            restoreFileInput: document.getElementById('restoreFileInput'),
            resetDataBtn: document.getElementById('resetDataBtn'),
            tableInfo: document.getElementById('tableInfo'),
            pagination: document.getElementById('pagination'),
            totalPenerima: document.getElementById('totalPenerima'),
            totalBarang: document.getElementById('totalBarang'),
            tahunAktif: document.getElementById('tahunAktif'),
            totalNilai: document.getElementById('totalNilai'),
            totalDataCount: document.getElementById('totalDataCount'),
            installDate: document.getElementById('installDate'),
            browserInfo: document.getElementById('browserInfo'),
            linkModal: document.getElementById('linkModal'),
            modalLinkInput: document.getElementById('modalLinkInput'),
            saveLinkBtn: document.getElementById('saveLinkBtn'),
            printInstitutionName: document.getElementById('printInstitutionName'),
            printDate: document.getElementById('printDate')
        };
        
        // Inisialisasi aplikasi
        document.addEventListener('DOMContentLoaded', function() {
            // Inisialisasi tooltip Bootstrap
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
            
            // Inisialisasi toast
            const successToast = new bootstrap.Toast(domElements.successToast);
            const errorToast = new bootstrap.Toast(domElements.errorToast);
            
            // Inisialisasi modal
            const confirmationModal = new bootstrap.Modal(domElements.confirmationModal);
            const linkModal = new bootstrap.Modal(domElements.linkModal);
            
            // Cek status login
            checkLoginStatus();
            
            // Inisialisasi form tahun anggaran
            initTahunAnggaran();
            
            // Event listeners
            initEventListeners();
            
            // Tampilkan splash screen
            showSplashScreen();
        });
        
        // Fungsi untuk inisialisasi tahun anggaran
        function initTahunAnggaran() {
            const tahunSelect = document.getElementById('tahunAnggaran');
            const filterTahunSelect = document.getElementById('filterTahun');
            
            // Kosongkan opsi yang ada
            tahunSelect.innerHTML = '<option value="" selected disabled>Pilih Tahun Anggaran</option>';
            filterTahunSelect.innerHTML = '<option value="all">Semua Tahun</option>';
            
            // Tambahkan opsi tahun dari 2020 hingga 2090
            for (let tahun = 2020; tahun <= 2090; tahun++) {
                const option = document.createElement('option');
                option.value = tahun;
                option.textContent = tahun;
                
                const filterOption = option.cloneNode(true);
                
                tahunSelect.appendChild(option);
                filterTahunSelect.appendChild(filterOption);
            }
            
            // Set tahun sekarang sebagai pilihan default
            const tahunSekarang = new Date().getFullYear();
            tahunSelect.value = tahunSekarang;
            filterTahunSelect.value = 'all';
        }
        
        // Fungsi untuk inisialisasi event listeners
        function initEventListeners() {
            // Event listener untuk form login
            domElements.loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            // Event listener untuk toggle password visibility
            document.querySelector('.toggle-password').addEventListener('click', function() {
                const passwordField = domElements.securityCode;
                const icon = this.querySelector('i');
                
                if (passwordField.type === 'password') {
                    passwordField.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    passwordField.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
            
            // Event listener untuk tombol tutup splash screen
            domElements.closeSplash.addEventListener('click', function() {
                hideSplashScreen();
            });
            
            // Event listener untuk menu navigasi
            domElements.navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Keluar aplikasi jika klik logout
                    if (this.id === 'logoutBtn') {
                        handleLogout();
                        return;
                    }
                    
                    // Toggle kelas active pada menu
                    domElements.navLinks.forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Tampilkan section yang sesuai
                    const target = this.getAttribute('data-bs-target');
                    showSection(target);
                });
            });
            
            // Event listener untuk mobile menu button
            domElements.mobileMenuBtn.addEventListener('click', function() {
                domElements.sidebar.classList.toggle('mobile-show');
                domElements.sidebarOverlay.classList.toggle('mobile-show');
            });
            
            // Event listener untuk sidebar overlay
            domElements.sidebarOverlay.addEventListener('click', function() {
                domElements.sidebar.classList.remove('mobile-show');
                this.classList.remove('mobile-show');
            });
            
            // Event listener untuk scroll to top button
            domElements.scrollTopBtn.addEventListener('click', function() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // Event listener untuk form input data
            domElements.dataForm.addEventListener('submit', function(e) {
                e.preventDefault();
                handleDataSubmit();
            });
            
            // Event listener untuk form pengaturan instansi
            domElements.institutionForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveInstitutionSettings();
            });
            
            // Event listener untuk validasi NIK (hanya angka, maksimal 16 digit)
            document.getElementById('nikKtp').addEventListener('input', function(e) {
                this.value = this.value.replace(/\D/g, '').slice(0, 16);
                validateNik(this.value);
            });
            
            // Event listener untuk validasi nomor WhatsApp
            document.getElementById('nomorWhatsapp').addEventListener('input', function(e) {
                // Hapus semua karakter non-digit
                this.value = this.value.replace(/\D/g, '');
                
                // Jika dimulai dengan 0, ganti dengan 62
                if (this.value.startsWith('0')) {
                    this.value = '62' + this.value.substring(1);
                }
                
                validateWhatsapp(this.value);
            });
            
            // Event listener untuk auto-uppercase pada nama, kelompok, dan barang
            document.getElementById('namaPenerima').addEventListener('input', function(e) {
                this.value = this.value.toUpperCase();
                validateNama(this.value);
            });
            
            document.getElementById('namaKelompok').addEventListener('input', function(e) {
                this.value = this.value.toUpperCase();
                validateKelompok(this.value);
            });
            
            document.getElementById('namaBarang').addEventListener('input', function(e) {
                this.value = this.value.toUpperCase();
                validateBarang(this.value);
            });
            
            // Event listener untuk filter tahun
            domElements.filterTahun.addEventListener('change', function() {
                appState.currentPage = 1;
                renderDataTable();
            });
            
            // Event listener untuk pencarian
            domElements.searchInput.addEventListener('input', debounce(function() {
                appState.currentPage = 1;
                renderDataTable();
            }, 300));
            
            // Event listener untuk ekspor data
            domElements.exportExcelBtn.addEventListener('click', function() {
                exportToExcel();
            });
            
            domElements.exportPdfBtn.addEventListener('click', function() {
                exportToPDF();
            });
            
            // Event listener untuk backup data
            domElements.backupDataBtn.addEventListener('click', function() {
                backupData();
            });
            
            // Event listener untuk restore data
            domElements.restoreDataBtn.addEventListener('click', function() {
                domElements.restoreFileInput.click();
            });
            
            domElements.restoreFileInput.addEventListener('change', function(e) {
                restoreData(e.target.files[0]);
            });
            
            // Event listener untuk reset data
            domElements.resetDataBtn.addEventListener('click', function() {
                showConfirmationModal(
                    "Hapus Semua Data",
                    "Apakah Anda yakin ingin menghapus semua data? Tindakan ini tidak dapat dibatalkan.",
                    function() {
                        resetData();
                    }
                );
            });
            
            // Event listener untuk save link di modal
            domElements.saveLinkBtn.addEventListener('click', function() {
                saveLink();
            });
            
            // Event listener untuk scroll window
            window.addEventListener('scroll', function() {
                toggleScrollTopButton();
            });
            
            // Event listener untuk sebelum cetak
            window.addEventListener('beforeprint', function() {
                preparePrint();
            });
            
            // Event listener untuk setelah cetak
            window.addEventListener('afterprint', function() {
                afterPrint();
            });
        }
        
        // Fungsi untuk menampilkan section tertentu
        function showSection(sectionId) {
            // Sembunyikan semua section
            domElements.contentSections.forEach(section => {
                section.classList.add('d-none');
            });
            
            // Tampilkan section yang dipilih
            document.getElementById(sectionId).classList.remove('d-none');
            
            // Jika section adalah dashboard, perbarui statistik
            if (sectionId === 'dashboard') {
                updateDashboardStats();
            }
            
            // Jika section adalah tabel data, render tabel
            if (sectionId === 'dataTable') {
                renderDataTable();
            }
            
            // Jika section adalah settings, perbarui informasi
            if (sectionId === 'settings') {
                updateSettingsInfo();
            }
            
            // Scroll ke atas
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Tutup sidebar di mode mobile
            if (window.innerWidth < 992) {
                domElements.sidebar.classList.remove('mobile-show');
                domElements.sidebarOverlay.classList.remove('mobile-show');
            }
        }
        
        // Fungsi untuk memeriksa status login
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const loginExpiry = localStorage.getItem('loginExpiry');
            
            if (isLoggedIn && loginExpiry && new Date().getTime() < parseInt(loginExpiry)) {
                // User sudah login dan sesi masih berlaku
                appState.isLoggedIn = true;
                domElements.loginModal.classList.remove('show');
                document.body.classList.remove('modal-open');
                document.querySelector('.modal-backdrop')?.remove();
                
                // Muat data dari localStorage
                loadData();
                
                // Perbarui UI
                updateUIAfterLogin();
            } else {
                // User belum login atau sesi telah kedaluwarsa
                appState.isLoggedIn = false;
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('loginExpiry');
                
                // Tampilkan modal login
                const loginModal = new bootstrap.Modal(domElements.loginModal);
                loginModal.show();
            }
        }
        
        // Fungsi untuk menangani login
        function handleLogin() {
            const securityCode = domElements.securityCode.value.trim();
            
            // Validasi kode keamanan
            if (!securityCode) {
                showError('Harap masukkan kode keamanan');
                domElements.securityCode.classList.add('input-error');
                return;
            }
            
            // Tampilkan spinner
            domElements.loginButton.disabled = true;
            domElements.loginSpinner.classList.remove('d-none');
            document.querySelector('.login-button-text').textContent = 'Memverifikasi...';
            
            // Simulasi proses verifikasi (dalam aplikasi nyata, ini akan memverifikasi dengan backend)
            setTimeout(() => {
                if (securityCode === APP_CONFIG.securityCode) {
                    // Login berhasil
                    loginSuccess();
                } else {
                    // Login gagal
                    loginFailed();
                }
            }, 1000);
        }
        
        // Fungsi ketika login berhasil
        function loginSuccess() {
            // Reset state login
            appState.loginAttempts = 0;
            appState.isBlocked = false;
            clearInterval(appState.blockTimer);
            
            // Set status login
            appState.isLoggedIn = true;
            const now = new Date();
            const expiryTime = now.getTime() + (8 * 60 * 60 * 1000); // 8 jam
            
            localStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('loginExpiry', expiryTime.toString());
            
            // Sembunyikan modal login
            const loginModal = bootstrap.Modal.getInstance(domElements.loginModal);
            loginModal.hide();
            
            // Reset form login
            domElements.loginForm.reset();
            
            // Sembunyikan spinner
            domElements.loginButton.disabled = false;
            domElements.loginSpinner.classList.add('d-none');
            document.querySelector('.login-button-text').textContent = 'Masuk ke Aplikasi';
            
            // Perbarui UI
            updateUIAfterLogin();
            
            // Muat data dari localStorage
            loadData();
            
            // Tampilkan notifikasi
            showSuccess('Login berhasil! Selamat datang di aplikasi BARJAS.');
        }
        
        // Fungsi ketika login gagal
        function loginFailed() {
            // Tambahkan attempt
            appState.loginAttempts++;
            
            // Sembunyikan spinner
            domElements.loginButton.disabled = false;
            domElements.loginSpinner.classList.add('d-none');
            document.querySelector('.login-button-text').textContent = 'Masuk ke Aplikasi';
            
            // Cek jika sudah melebihi batas attempt
            if (appState.loginAttempts >= APP_CONFIG.maxLoginAttempts) {
                // Blokir login sementara
                appState.isBlocked = true;
                appState.blockTimeRemaining = APP_CONFIG.loginBlockTime;
                
                // Tampilkan pesan blokir
                domElements.blockedMessage.classList.remove('d-none');
                domElements.attemptsCount.classList.add('d-none');
                domElements.loginButton.disabled = true;
                
                // Start countdown
                appState.blockTimer = setInterval(() => {
                    appState.blockTimeRemaining--;
                    domElements.countdown.textContent = appState.blockTimeRemaining;
                    
                    if (appState.blockTimeRemaining <= 0) {
                        clearInterval(appState.blockTimer);
                        appState.isBlocked = false;
                        appState.loginAttempts = 0;
                        
                        domElements.blockedMessage.classList.add('d-none');
                        domElements.attemptsCount.classList.add('d-none');
                        domElements.loginButton.disabled = false;
                    }
                }, 1000);
            } else {
                // Tampilkan sisa percobaan
                const remainingAttempts = APP_CONFIG.maxLoginAttempts - appState.loginAttempts;
                domElements.attemptsCount.textContent = `Kode salah! Sisa percobaan: ${remainingAttempts}`;
                domElements.attemptsCount.classList.remove('d-none');
                
                // Animasi shake
                domElements.loginForm.classList.add('login-shake');
                setTimeout(() => {
                    domElements.loginForm.classList.remove('login-shake');
                }, 600);
            }
            
            // Focus ke input kode
            domElements.securityCode.focus();
        }
        
        // Fungsi untuk menangani logout
        function handleLogout() {
            showConfirmationModal(
                "Konfirmasi Keluar",
                "Apakah Anda yakin ingin keluar dari aplikasi?",
                function() {
                    // Hapus status login
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('loginExpiry');
                    
                    // Reset state
                    appState.isLoggedIn = false;
                    
                    // Tampilkan modal login
                    const loginModal = new bootstrap.Modal(domElements.loginModal);
                    loginModal.show();
                    
                    // Tampilkan notifikasi
                    showSuccess('Anda telah berhasil keluar dari aplikasi.');
                }
            );
        }
        
        // Fungsi untuk memperbarui UI setelah login
        function updateUIAfterLogin() {
            // Muat pengaturan instansi
            loadInstitutionSettings();
            
            // Tampilkan dashboard sebagai default
            showSection('dashboard');
        }
        
        // Fungsi untuk menampilkan splash screen
        function showSplashScreen() {
            let countdown = 5;
            
            const countdownInterval = setInterval(() => {
                countdown--;
                domElements.countdownTimer.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    hideSplashScreen();
                }
            }, 1000);
        }
        
        // Fungsi untuk menyembunyikan splash screen
        function hideSplashScreen() {
            domElements.welcomeSplash.style.opacity = '0';
            setTimeout(() => {
                domElements.welcomeSplash.style.display = 'none';
            }, 500);
        }
        
        // Fungsi untuk memuat data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem('bantuanData');
            if (savedData) {
                appState.currentData = JSON.parse(savedData);
            } else {
                appState.currentData = [];
            }
        }
        
        // Fungsi untuk menyimpan data ke localStorage
        function saveData() {
            localStorage.setItem('bantuanData', JSON.stringify(appState.currentData));
        }
        
        // Fungsi untuk memuat pengaturan instansi
        function loadInstitutionSettings() {
            const institutionName = localStorage.getItem('institutionName');
            const institutionLogoUrl = localStorage.getItem('institutionLogoUrl');
            
            if (institutionName) {
                domElements.institutionName.textContent = institutionName;
                domElements.institutionNameInput.value = institutionName;
                domElements.printInstitutionName.textContent = institutionName;
            }
            
            if (institutionLogoUrl) {
                domElements.institutionLogoUrl.value = institutionLogoUrl;
            } else {
                domElements.institutionLogoUrl.value = APP_CONFIG.defaultLogoUrl;
            }
        }
        
        // Fungsi untuk menyimpan pengaturan instansi
        function saveInstitutionSettings() {
            const institutionName = domElements.institutionNameInput.value.trim();
            const institutionLogoUrl = domElements.institutionLogoUrl.value.trim();
            
            if (institutionName) {
                localStorage.setItem('institutionName', institutionName);
                domElements.institutionName.textContent = institutionName;
                domElements.printInstitutionName.textContent = institutionName;
            }
            
            if (institutionLogoUrl) {
                localStorage.setItem('institutionLogoUrl', institutionLogoUrl);
            } else {
                localStorage.setItem('institutionLogoUrl', APP_CONFIG.defaultLogoUrl);
            }
            
            showSuccess('Pengaturan instansi berhasil disimpan.');
        }
        
        // Fungsi untuk menangani submit data bantuan
        function handleDataSubmit() {
            // Ambil nilai dari form
            const namaPenerima = document.getElementById('namaPenerima').value.trim();
            const nikKtp = document.getElementById('nikKtp').value.trim();
            const namaKelompok = document.getElementById('namaKelompok').value.trim();
            const namaBarang = document.getElementById('namaBarang').value.trim();
            const tahunAnggaran = document.getElementById('tahunAnggaran').value;
            const nomorWhatsapp = document.getElementById('nomorWhatsapp').value.trim();
            const linkGoogleDrive = document.getElementById('linkGoogleDrive').value.trim();
            
            // Validasi form
            if (!validateForm(namaPenerima, nikKtp, namaKelompok, namaBarang, tahunAnggaran, nomorWhatsapp)) {
                return;
            }
            
            // Buat ID unik
            const id = Date.now().toString();
            
            // Buat objek data
            const data = {
                id: id,
                namaPenerima: namaPenerima.toUpperCase(),
                nikKtp: nikKtp,
                namaKelompok: namaKelompok.toUpperCase(),
                namaBarang: namaBarang.toUpperCase(),
                tahunAnggaran: tahunAnggaran,
                nomorWhatsapp: nomorWhatsapp,
                linkGoogleDrive: linkGoogleDrive || '-',
                tanggalInput: new Date().toISOString()
            };
            
            // Tambahkan ke data saat ini
            if (appState.currentEditId) {
                // Mode edit - cari data yang akan diedit
                const index = appState.currentData.findIndex(item => item.id === appState.currentEditId);
                if (index !== -1) {
                    appState.currentData[index] = {
                        ...appState.currentData[index],
                        namaPenerima: data.namaPenerima,
                        nikKtp: data.nikKtp,
                        namaKelompok: data.namaKelompok,
                        namaBarang: data.namaBarang,
                        tahunAnggaran: data.tahunAnggaran,
                        nomorWhatsapp: data.nomorWhatsapp,
                        linkGoogleDrive: data.linkGoogleDrive
                    };
                }
                appState.currentEditId = null;
            } else {
                // Mode tambah - tambahkan data baru
                appState.currentData.unshift(data);
            }
            
            // Simpan ke localStorage
            saveData();
            
            // Reset form
            domElements.dataForm.reset();
            
            // Perbarui UI
            updateDashboardStats();
            
            // Tampilkan notifikasi
            if (appState.currentEditId) {
                showSuccess('Data berhasil diperbarui.');
            } else {
                showSuccess('Data berhasil disimpan.');
            }
        }
        
        // Fungsi untuk validasi form
        function validateForm(nama, nik, kelompok, barang, tahun, whatsapp) {
            let isValid = true;
            
            // Validasi nama
            if (!validateNama(nama)) {
                isValid = false;
            }
            
            // Validasi NIK
            if (!validateNik(nik)) {
                isValid = false;
            }
            
            // Validasi kelompok
            if (!validateKelompok(kelompok)) {
                isValid = false;
            }
            
            // Validasi barang
            if (!validateBarang(barang)) {
                isValid = false;
            }
            
            // Validasi tahun
            if (!tahun) {
                document.getElementById('tahunError').style.display = 'block';
                document.getElementById('tahunAnggaran').classList.add('input-error');
                isValid = false;
            } else {
                document.getElementById('tahunError').style.display = 'none';
                document.getElementById('tahunAnggaran').classList.remove('input-error');
            }
            
            // Validasi WhatsApp
            if (!validateWhatsapp(whatsapp)) {
                isValid = false;
            }
            
            return isValid;
        }
        
        // Fungsi validasi nama
        function validateNama(nama) {
            if (!nama || nama.length < 3) {
                document.getElementById('namaError').style.display = 'block';
                document.getElementById('namaPenerima').classList.add('input-error');
                return false;
            } else {
                document.getElementById('namaError').style.display = 'none';
                document.getElementById('namaPenerima').classList.remove('input-error');
                return true;
            }
        }
        
        // Fungsi validasi NIK
        function validateNik(nik) {
            if (!nik || nik.length !== 16) {
                document.getElementById('nikError').style.display = 'block';
                document.getElementById('nikKtp').classList.add('input-error');
                return false;
            } else {
                document.getElementById('nikError').style.display = 'none';
                document.getElementById('nikKtp').classList.remove('input-error');
                return true;
            }
        }
        
        // Fungsi validasi kelompok
        function validateKelompok(kelompok) {
            if (!kelompok) {
                document.getElementById('kelompokError').style.display = 'block';
                document.getElementById('namaKelompok').classList.add('input-error');
                return false;
            } else {
                document.getElementById('kelompokError').style.display = 'none';
                document.getElementById('namaKelompok').classList.remove('input-error');
                return true;
            }
        }
        
        // Fungsi validasi barang
        function validateBarang(barang) {
            if (!barang) {
                document.getElementById('barangError').style.display = 'block';
                document.getElementById('namaBarang').classList.add('input-error');
                return false;
            } else {
                document.getElementById('barangError').style.display = 'none';
                document.getElementById('namaBarang').classList.remove('input-error');
                return true;
            }
        }
        
        // Fungsi validasi WhatsApp
        function validateWhatsapp(whatsapp) {
            if (!whatsapp || whatsapp.length < 10) {
                document.getElementById('whatsappError').style.display = 'block';
                document.getElementById('nomorWhatsapp').classList.add('input-error');
                return false;
            } else {
                document.getElementById('whatsappError').style.display = 'none';
                document.getElementById('nomorWhatsapp').classList.remove('input-error');
                return true;
            }
        }
        
        // Fungsi untuk merender tabel data
        function renderDataTable() {
            const tbody = domElements.mainDataTable.querySelector('tbody');
            tbody.innerHTML = '';
            
            // Filter data berdasarkan tahun
            let filteredData = [...appState.currentData];
            const selectedYear = domElements.filterTahun.value;
            
            if (selectedYear !== 'all') {
                filteredData = filteredData.filter(item => item.tahunAnggaran === selectedYear);
            }
            
            // Filter data berdasarkan pencarian
            const searchTerm = domElements.searchInput.value.toLowerCase();
            if (searchTerm) {
                filteredData = filteredData.filter(item => 
                    item.namaPenerima.toLowerCase().includes(searchTerm) ||
                    item.nikKtp.includes(searchTerm) ||
                    item.namaKelompok.toLowerCase().includes(searchTerm) ||
                    item.namaBarang.toLowerCase().includes(searchTerm)
                );
            }
            
            // Urutkan data
            filteredData.sort((a, b) => {
                if (appState.sortDirection === 'asc') {
                    return a[appState.sortField] > b[appState.sortField] ? 1 : -1;
                } else {
                    return a[appState.sortField] < b[appState.sortField] ? 1 : -1;
                }
            });
            
            // Hitung total halaman
            const totalPages = Math.ceil(filteredData.length / APP_CONFIG.itemsPerPage);
            
            // Validasi current page
            if (appState.currentPage > totalPages) {
                appState.currentPage = totalPages || 1;
            }
            
            // Data untuk halaman saat ini
            const startIndex = (appState.currentPage - 1) * APP_CONFIG.itemsPerPage;
            const endIndex = startIndex + APP_CONFIG.itemsPerPage;
            const currentData = filteredData.slice(startIndex, endIndex);
            
            // Render data
            currentData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // Format nomor WhatsApp untuk link
                const whatsappLink = item.nomorWhatsapp.startsWith('62') ? 
                    `https://wa.me/${item.nomorWhatsapp}` : 
                    `tel:${item.nomorWhatsapp}`;
                
                row.innerHTML = `
                    <td class="text-center">${startIndex + index + 1}</td>
                    <td>${item.namaPenerima}</td>
                    <td class="text-center">${item.nikKtp}</td>
                    <td>${item.namaKelompok}</td>
                    <td>${item.namaBarang}</td>
                    <td class="text-center">${item.tahunAnggaran}</td>
                    <td class="text-center">
                        <a href="${whatsappLink}" target="_blank" class="whatsapp-link">
                            ${item.nomorWhatsapp}
                        </a>
                    </td>
                    <td class="text-center">
                        ${item.linkGoogleDrive !== '-' ? 
                            `<a href="${item.linkGoogleDrive}" target="_blank" class="drive-link">Lihat</a>` : 
                            '<span class="text-muted">-</span>'}
                    </td>
                    <td class="text-center">
                        <button class="btn btn-sm btn-primary me-1 edit-btn" data-id="${item.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger delete-btn" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="btn btn-sm btn-success ms-1 link-btn" data-id="${item.id}">
                            <i class="fas fa-link"></i>
                        </button>
                        <button class="btn btn-sm btn-print-individual ms-1 print-btn" data-id="${item.id}">
                            <i class="fas fa-print"></i>
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Render pagination
            renderPagination(totalPages);
            
            // Update table info
            domElements.tableInfo.textContent = `Menampilkan ${filteredData.length} data`;
            
            // Tambahkan event listener untuk tombol aksi
            addTableActionListeners();
        }
        
        // Fungsi untuk merender pagination
        function renderPagination(totalPages) {
            domElements.pagination.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Tombol Previous
            const prevLi = document.createElement('li');
            prevLi.classList.add('page-item');
            if (appState.currentPage === 1) {
                prevLi.classList.add('disabled');
            }
            prevLi.innerHTML = `<a class="page-link" href="#">Previous</a>`;
            prevLi.addEventListener('click', function(e) {
                e.preventDefault();
                if (appState.currentPage > 1) {
                    appState.currentPage--;
                    renderDataTable();
                }
            });
            domElements.pagination.appendChild(prevLi);
            
            // Numbered pages
            const startPage = Math.max(1, appState.currentPage - 2);
            const endPage = Math.min(totalPages, startPage + 4);
            
            for (let i = startPage; i <= endPage; i++) {
                const pageLi = document.createElement('li');
                pageLi.classList.add('page-item');
                if (i === appState.currentPage) {
                    pageLi.classList.add('active');
                }
                pageLi.innerHTML = `<a class="page-link" href="#">${i}</a>`;
                pageLi.addEventListener('click', function(e) {
                    e.preventDefault();
                    appState.currentPage = i;
                    renderDataTable();
                });
                domElements.pagination.appendChild(pageLi);
            }
            
            // Tombol Next
            const nextLi = document.createElement('li');
            nextLi.classList.add('page-item');
            if (appState.currentPage === totalPages) {
                nextLi.classList.add('disabled');
            }
            nextLi.innerHTML = `<a class="page-link" href="#">Next</a>`;
            nextLi.addEventListener('click', function(e) {
                e.preventDefault();
                if (appState.currentPage < totalPages) {
                    appState.currentPage++;
                    renderDataTable();
                }
            });
            domElements.pagination.appendChild(nextLi);
        }
        
        // Fungsi untuk menambahkan event listener pada tombol aksi di tabel
        function addTableActionListeners() {
            // Tombol edit
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editData(id);
                });
            });
            
            // Tombol hapus
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteData(id);
                });
            });
            
            // Tombol link
            document.querySelectorAll('.link-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editLink(id);
                });
            });
            
            // Tombol print individual
            document.querySelectorAll('.print-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    printIndividualData(id);
                });
            });
        }
        
        // Fungsi untuk mengedit data
        function editData(id) {
            const data = appState.currentData.find(item => item.id === id);
            if (!data) return;
            
            // Isi form dengan data yang akan diedit
            document.getElementById('namaPenerima').value = data.namaPenerima;
            document.getElementById('nikKtp').value = data.nikKtp;
            document.getElementById('namaKelompok').value = data.namaKelompok;
            document.getElementById('namaBarang').value = data.namaBarang;
            document.getElementById('tahunAnggaran').value = data.tahunAnggaran;
            document.getElementById('nomorWhatsapp').value = data.nomorWhatsapp;
            document.getElementById('linkGoogleDrive').value = data.linkGoogleDrive !== '-' ? data.linkGoogleDrive : '';
            
            // Set state edit
            appState.currentEditId = id;
            
            // Scroll ke form input data
            showSection('inputData');
            
            // Tampilkan notifikasi
            showSuccess('Data siap untuk diedit. Silakan perbarui data yang diperlukan.');
        }
        
        // Fungsi untuk menghapus data
        function deleteData(id) {
            showConfirmationModal(
                "Hapus Data",
                "Apakah Anda yakin ingin menghapus data ini? Tindakan ini tidak dapat dibatalkan.",
                function() {
                    // Hapus data dari array
                    appState.currentData = appState.currentData.filter(item => item.id !== id);
                    
                    // Simpan ke localStorage
                    saveData();
                    
                    // Perbarui UI
                    updateDashboardStats();
                    renderDataTable();
                    
                    // Tampilkan notifikasi
                    showSuccess('Data berhasil dihapus.');
                }
            );
        }
        
        // Fungsi untuk mengedit link
        function editLink(id) {
            const data = appState.currentData.find(item => item.id === id);
            if (!data) return;
            
            // Isi modal dengan link saat ini
            domElements.modalLinkInput.value = data.linkGoogleDrive !== '-' ? data.linkGoogleDrive : '';
            
            // Simpan ID data yang sedang diedit
            appState.currentLinkEditId = id;
            
            // Tampilkan modal
            const linkModal = new bootstrap.Modal(domElements.linkModal);
            linkModal.show();
        }
        
        // Fungsi untuk menyimpan link
        function saveLink() {
            const link = domElements.modalLinkInput.value.trim();
            const id = appState.currentLinkEditId;
            
            if (!id) return;
            
            // Cari data dan perbarui link
            const index = appState.currentData.findIndex(item => item.id === id);
            if (index !== -1) {
                appState.currentData[index].linkGoogleDrive = link || '-';
                
                // Simpan ke localStorage
                saveData();
                
                // Perbarui tabel
                renderDataTable();
                
                // Sembunyikan modal
                const linkModal = bootstrap.Modal.getInstance(domElements.linkModal);
                linkModal.hide();
                
                // Tampilkan notifikasi
                showSuccess('Link berhasil diperbarui.');
            }
        }
        
        // Fungsi untuk mencetak data individual
        function printIndividualData(id) {
            const data = appState.currentData.find(item => item.id === id);
            if (!data) return;
            
            // Buat konten untuk dicetak
            const printContent = `
                <div style="padding: 20px; font-family: Arial, sans-serif;">
                    <h2 style="text-align: center; margin-bottom: 20px;">DATA BANTUAN INDIVIDUAL</h2>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="width: 30%; padding: 8px; border: 1px solid #ddd; font-weight: bold;">Nama Penerima</td>
                            <td style="width: 70%; padding: 8px; border: 1px solid #ddd;">${data.namaPenerima}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">NIK KTP</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${data.nikKtp}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Nama Kelompok</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${data.namaKelompok}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Nama Barang</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${data.namaBarang}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Tahun Anggaran</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${data.tahunAnggaran}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Nomor WhatsApp</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${data.nomorWhatsapp}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Link Google Drive</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${data.linkGoogleDrive !== '-' ? data.linkGoogleDrive : '-'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Tanggal Input</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${new Date(data.tanggalInput).toLocaleDateString('id-ID')}</td>
                        </tr>
                    </table>
                    <div style="margin-top: 30px; text-align: right;">
                        <div>${new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                        <div style="margin-top: 60px;">Petugas</div>
                    </div>
                </div>
            `;
            
            // Buka jendela cetak
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>Cetak Data Bantuan - ${data.namaPenerima}</title>
                        <style>
                            body { font-family: Arial, sans-serif; }
                            @media print {
                                @page { size: portrait; margin: 0.5cm; }
                            }
                        </style>
                    </head>
                    <body onload="window.print(); window.close();">
                        ${printContent}
                    </body>
                </html>
            `);
            printWindow.document.close();
        }
        
        // Fungsi untuk memperbarui statistik dashboard
        function updateDashboardStats() {
            // Hitung total penerima
            domElements.totalPenerima.textContent = appState.currentData.length;
            
            // Hitung jenis barang unik
            const uniqueBarang = new Set(appState.currentData.map(item => item.namaBarang));
            domElements.totalBarang.textContent = uniqueBarang.size;
            
            // Tentukan tahun anggaran aktif (tahun dengan data terbanyak)
            const tahunCount = {};
            appState.currentData.forEach(item => {
                tahunCount[item.tahunAnggaran] = (tahunCount[item.tahunAnggaran] || 0) + 1;
            });
            
            let maxCount = 0;
            let tahunAktif = '-';
            for (const tahun in tahunCount) {
                if (tahunCount[tahun] > maxCount) {
                    maxCount = tahunCount[tahun];
                    tahunAktif = tahun;
                }
            }
            domElements.tahunAktif.textContent = tahunAktif;
            
            // Hitung total nilai bantuan (simulasi)
            const totalNilai = appState.currentData.length * 1500000; // Asumsi rata-rata 1.5 juta per bantuan
            domElements.totalNilai.textContent = formatRupiah(totalNilai);
            
            // Perbarui chart
            updateCharts();
            
            // Perbarui tabel data terbaru
            updateRecentDataTable();
        }
        
        // Fungsi untuk memperbarui chart
        function updateCharts() {
            // Data untuk chart tahunan
            const tahunData = {};
            appState.currentData.forEach(item => {
                tahunData[item.tahunAnggaran] = (tahunData[item.tahunAnggaran] || 0) + 1;
            });
            
            const tahunLabels = Object.keys(tahunData).sort();
            const tahunValues = tahunLabels.map(tahun => tahunData[tahun]);
            
            // Data untuk chart distribusi
            const barangData = {};
            appState.currentData.forEach(item => {
                barangData[item.namaBarang] = (barangData[item.namaBarang] || 0) + 1;
            });
            
            const barangLabels = Object.keys(barangData);
            const barangValues = barangLabels.map(barang => barangData[barang]);
            
            // Hancurkan chart yang sudah ada jika ada
            if (appState.charts.yearlyChart) {
                appState.charts.yearlyChart.destroy();
            }
            
            if (appState.charts.distributionChart) {
                appState.charts.distributionChart.destroy();
            }
            
            // Buat chart tahunan
            const yearlyCtx = document.getElementById('yearlyChart').getContext('2d');
            appState.charts.yearlyChart = new Chart(yearlyCtx, {
                type: 'bar',
                data: {
                    labels: tahunLabels,
                    datasets: [{
                        label: 'Jumlah Bantuan per Tahun',
                        data: tahunValues,
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    }
                }
            });
            
            // Buat chart distribusi
            const distributionCtx = document.getElementById('distributionChart').getContext('2d');
            appState.charts.distributionChart = new Chart(distributionCtx, {
                type: 'pie',
                data: {
                    labels: barangLabels,
                    datasets: [{
                        data: barangValues,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(153, 102, 255, 0.7)',
                            'rgba(255, 159, 64, 0.7)',
                            'rgba(199, 199, 199, 0.7)',
                            'rgba(83, 102, 255, 0.7)',
                            'rgba(40, 159, 64, 0.7)',
                            'rgba(210, 99, 132, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk memperbarui tabel data terbaru
        function updateRecentDataTable() {
            const tbody = domElements.recentDataTable.querySelector('tbody');
            tbody.innerHTML = '';
            
            // Ambil 5 data terbaru
            const recentData = [...appState.currentData]
                .sort((a, b) => new Date(b.tanggalInput) - new Date(a.tanggalInput))
                .slice(0, 5);
            
            recentData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // Format nomor WhatsApp untuk link
                const whatsappLink = item.nomorWhatsapp.startsWith('62') ? 
                    `https://wa.me/${item.nomorWhatsapp}` : 
                    `tel:${item.nomorWhatsapp}`;
                
                row.innerHTML = `
                    <td class="text-center">${index + 1}</td>
                    <td>${item.namaPenerima}</td>
                    <td class="text-center">${item.nikKtp}</td>
                    <td>${item.namaKelompok}</td>
                    <td>${item.namaBarang}</td>
                    <td class="text-center">${item.tahunAnggaran}</td>
                    <td class="text-center">
                        <a href="${whatsappLink}" target="_blank" class="whatsapp-link">
                            ${item.nomorWhatsapp}
                        </a>
                    </td>
                    <td class="text-center">
                        <button class="btn btn-sm btn-primary me-1 edit-btn" data-id="${item.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger delete-btn" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Tambahkan event listener untuk tombol aksi
            addTableActionListeners();
        }
        
        // Fungsi untuk memperbarui informasi pengaturan
        function updateSettingsInfo() {
            // Total data
            domElements.totalDataCount.textContent = appState.currentData.length;
            
            // Tanggal install
            const installDate = localStorage.getItem('installDate');
            if (installDate) {
                domElements.installDate.textContent = new Date(parseInt(installDate)).toLocaleDateString('id-ID');
            } else {
                const now = new Date().getTime();
                localStorage.setItem('installDate', now.toString());
                domElements.installDate.textContent = new Date(now).toLocaleDateString('id-ID');
            }
            
            // Informasi browser
            domElements.browserInfo.textContent = navigator.userAgent.split(' ')[0];
        }
        
        // Fungsi untuk ekspor data ke Excel
        function exportToExcel() {
            if (appState.currentData.length === 0) {
                showError('Tidak ada data untuk diekspor.');
                return;
            }
            
            try {
                // Siapkan data untuk diekspor
                const dataToExport = appState.currentData.map(item => ({
                    'Nama Penerima': item.namaPenerima,
                    'NIK KTP': item.nikKtp,
                    'Nama Kelompok': item.namaKelompok,
                    'Nama Barang': item.namaBarang,
                    'Tahun Anggaran': item.tahunAnggaran,
                    'Nomor WhatsApp': item.nomorWhatsapp,
                    'Link Google Drive': item.linkGoogleDrive,
                    'Tanggal Input': new Date(item.tanggalInput).toLocaleDateString('id-ID')
                }));
                
                // Bu worksheet
                const worksheet = XLSX.utils.json_to_sheet(dataToExport);
                
                // Bu workbook
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, 'Data Bantuan');
                
                // Ekspor ke file
                const institutionName = localStorage.getItem('institutionName') || 'Instansi';
                const date = new Date().toISOString().slice(0, 10);
                const fileName = `Data_Bantuan_${institutionName}_${date}.xlsx`;
                
                XLSX.writeFile(workbook, fileName);
                
                showSuccess('Data berhasil diekspor ke Excel.');
            } catch (error) {
                console.error('Error exporting to Excel:', error);
                showError('Terjadi kesalahan saat mengekspor data ke Excel.');
            }
        }
        
        // Fungsi untuk ekspor data ke PDF
        function exportToPDF() {
            if (appState.currentData.length === 0) {
                showError('Tidak ada data untuk diekspor.');
                return;
            }
            
            try {
                // Gunakan jsPDF dengan autotable
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Judul
                const institutionName = localStorage.getItem('institutionName') || 'Instansi';
                const date = new Date().toLocaleDateString('id-ID');
                
                doc.setFontSize(18);
                doc.text('LAPORAN DATA BANTUAN', 105, 15, { align: 'center' });
                
                doc.setFontSize(12);
                doc.text(institutionName, 105, 22, { align: 'center' });
                doc.text(`Tanggal: ${date}`, 105, 29, { align: 'center' });
                
                // Siapkan data untuk tabel
                const tableData = appState.currentData.map(item => [
                    item.namaPenerima,
                    item.nikKtp,
                    item.namaKelompok,
                    item.namaBarang,
                    item.tahunAnggaran,
                    item.nomorWhatsapp,
                    item.linkGoogleDrive !== '-' ? 'Ada' : 'Tidak Ada',
                    new Date(item.tanggalInput).toLocaleDateString('id-ID')
                ]);
                
                // Buat tabel
                doc.autoTable({
                    startY: 35,
                    head: [['Nama', 'NIK', 'Kelompok', 'Barang', 'Tahun', 'WhatsApp', 'Link', 'Tanggal Input']],
                    body: tableData,
                    theme: 'grid',
                    headStyles: {
                        fillColor: [13, 71, 161],
                        textColor: 255,
                        fontStyle: 'bold'
                    },
                    alternateRowStyles: {
                        fillColor: [240, 240, 240]
                    },
                    margin: { top: 35 }
                });
                
                // Simpan PDF
                doc.save(`Data_Bantuan_${institutionName}_${new Date().toISOString().slice(0, 10)}.pdf`);
                
                showSuccess('Data berhasil diekspor ke PDF.');
            } catch (error) {
                console.error('Error exporting to PDF:', error);
                showError('Terjadi kesalahan saat mengekspor data ke PDF.');
            }
        }
        
        // Fungsi untuk backup data
        function backupData() {
            if (appState.currentData.length === 0) {
                showError('Tidak ada data untuk dibackup.');
                return;
            }
            
            try {
                // Buat objek backup
                const backup = {
                    app: APP_CONFIG.appName,
                    version: APP_CONFIG.appVersion,
                    timestamp: new Date().toISOString(),
                    data: appState.currentData
                };
                
                // Konversi ke JSON
                const backupData = JSON.stringify(backup);
                
                // Buat blob dan URL
                const blob = new Blob([backupData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                // Buat elemen anchor untuk download
                const a = document.createElement('a');
                a.href = url;
                a.download = `backup_bantuan_${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(a);
                a.click();
                
                // Bersihkan
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                showSuccess('Backup data berhasil dilakukan.');
            } catch (error) {
                console.error('Error backing up data:', error);
                showError('Terjadi kesalahan saat melakukan backup data.');
            }
        }
        
        // Fungsi untuk restore data
        function restoreData(file) {
            if (!file) return;
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const backup = JSON.parse(e.target.result);
                    
                    // Validasi file backup
                    if (!backup.app || backup.app !== APP_CONFIG.appName) {
                        showError('File backup tidak valid.');
                        return;
                    }
                    
                    // Tampilkan konfirmasi
                    showConfirmationModal(
                        "Restore Data",
                        "Apakah Anda yakin ingin merestore data? Data saat ini akan diganti dengan data dari backup.",
                        function() {
                            // Simpan data
                            appState.currentData = backup.data || [];
                            saveData();
                            
                            // Perbarui UI
                            updateDashboardStats();
                            renderDataTable();
                            
                            showSuccess('Data berhasil direstore dari backup.');
                        }
                    );
                } catch (error) {
                    console.error('Error restoring data:', error);
                    showError('Terjadi kesalahan saat merestore data. File mungkin rusak atau tidak valid.');
                }
            };
            
            reader.onerror = function() {
                showError('Terjadi kesalahan saat membaca file.');
            };
            
            reader.readAsText(file);
        }
        
        // Fungsi untuk reset data
        function resetData() {
            // Reset data
            appState.currentData = [];
            saveData();
            
            // Perbarui UI
            updateDashboardStats();
            renderDataTable();
            
            showSuccess('Semua data berhasil dihapus.');
        }
        
        // Fungsi untuk menampilkan modal konfirmasi
        function showConfirmationModal(title, message, confirmCallback) {
            domElements.confirmationModalTitle.textContent = title;
            domElements.confirmationModalBody.textContent = message;
            
            const modal = new bootstrap.Modal(domElements.confirmationModal);
            modal.show();
            
            // Hapus event listener sebelumnya dan tambahkan yang baru
            domElements.confirmationModalConfirm.replaceWith(domElements.confirmationModalConfirm.cloneNode(true));
            const newConfirmBtn = document.getElementById('confirmationModalConfirm');
            
            newConfirmBtn.addEventListener('click', function() {
                modal.hide();
                confirmCallback();
            });
        }
        
        // Fungsi untuk menampilkan notifikasi sukses
        function showSuccess(message) {
            domElements.toastMessage.textContent = message;
            const successToast = new bootstrap.Toast(domElements.successToast);
            successToast.show();
        }
        
        // Fungsi untuk menampilkan notifikasi error
        function showError(message) {
            domElements.errorToastMessage.textContent = message;
            const errorToast = new bootstrap.Toast(domElements.errorToast);
            errorToast.show();
        }
        
        // Fungsi untuk toggle scroll to top button
        function toggleScrollTopButton() {
            if (window.scrollY > 300) {
                domElements.scrollTopBtn.style.display = 'flex';
            } else {
                domElements.scrollTopBtn.style.display = 'none';
            }
        }
        
        // Fungsi untuk memformat angka menjadi format Rupiah
        function formatRupiah(angka) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(angka);
        }
        
        // Fungsi debounce untuk pencarian
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Fungsi untuk persiapan sebelum cetak
        function preparePrint() {
            // Set judul instansi untuk dicetak
            const institutionName = localStorage.getItem('institutionName') || 'Nama Instansi/Lembaga';
            domElements.printInstitutionName.textContent = institutionName;
            
            // Set tanggal cetak
            domElements.printDate.textContent = new Date().toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }
        
        // Fungsi untuk setelah cetak
        function afterPrint() {
            // Tidak ada yang perlu dilakukan untuk saat ini
        }
        
        // Inisialisasi saat halaman dimuat
        window.onload = function() {
            // Cek jika browser mendukung fitur yang diperlukan
            if (typeof Storage === 'undefined') {
                alert('Browser Anda tidak mendukung Web Storage. Aplikasi tidak dapat berfungsi dengan baik.');
                return;
            }
            
            // Tampilkan modal login
            const loginModal = new bootstrap.Modal(domElements.loginModal);
            loginModal.show();
        };
    </script>
</body>
</html>
