<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - SISTEM BANTUAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* Semua style CSS yang asli tetap dipertahankan di sini */
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --login-gradient: linear-gradient(135deg, #0d47a1, #00695c, #ff8f00);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1.1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .developer-info h6 {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #ddd;
        }
        
        .developer-contact p {
            margin-bottom: 8px;
            font-size: 0.85rem;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Login Modal Styles */
        .login-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .login-header {
            background: var(--login-gradient);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }

        .login-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin: 5px 0 0;
        }

        .login-body {
            padding: 25px;
            position: relative;
            z-index: 1;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-label {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .login-form-label i {
            margin-right: 10px;
            color: var(--dark-blue);
        }

        .login-form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .login-form-control:focus {
            border-color: var(--dark-blue);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
        }

        .login-input-group-text {
            background: var(--light-blue);
            border: 2px solid #ddd;
            border-left: none;
        }

        .btn-login {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 105, 92, 0.4);
        }

        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-security-notice {
            text-align: center;
            margin-top: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        .login-attempts-count {
            text-align: center;
            font-size: 0.9rem;
            color: #ff8f00;
            font-weight: 500;
            margin-top: 5px;
        }

        .login-blocked-message {
            text-align: center;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            color: #dc3545;
            font-weight: 500;
        }

        .login-countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .login-developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .login-developer-info h6 {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .login-developer-info p {
            margin-bottom: 5px;
            font-size: 0.85rem;
        }

        .login-developer-info a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }

        .login-developer-info a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <div class="app-container">
        <div class="app-header">
            <div class="app-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="app-title">BARJAS</h1>
            <p class="app-subtitle">Sistem Bantuan Terpadu</p>
            <div class="watermark">
                <i class="fas fa-lock me-1"></i> Aman & Terenkripsi
            </div>
        </div>
        
        <div class="row g-0">
            <!-- Sidebar Navigation -->
            <div class="col-md-3 col-lg-2 p-4 bg-light" id="sidebarMenu">
                <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                    <a class="nav-link active" id="v-pills-dashboard-tab" data-bs-toggle="pill" href="#v-pills-dashboard" role="tab" aria-controls="v-pills-dashboard" aria-selected="true">
                        <i class="fas fa-tachometer-alt feature-icon"></i> Dashboard
                    </a>
                    <a class="nav-link" id="v-pills-input-tab" data-bs-toggle="pill" href="#v-pills-input" role="tab" aria-controls="v-pills-input" aria-selected="false">
                        <i class="fas fa-plus-circle feature-icon"></i> Input Data
                    </a>
                    <a class="nav-link" id="v-pills-data-tab" data-bs-toggle="pill" href="#v-pills-data" role="tab" aria-controls="v-pills-data" aria-selected="false">
                        <i class="fas fa-database feature-icon"></i> Data Bantuan
                    </a>
                    <a class="nav-link" id="v-pills-statistik-tab" data-bs-toggle="pill" href="#v-pills-statistik" role="tab" aria-controls="v-pills-statistik" aria-selected="false">
                        <i class="fas fa-chart-bar feature-icon"></i> Statistik
                    </a>
                    <a class="nav-link" id="v-pills-laporan-tab" data-bs-toggle="pill" href="#v-pills-laporan" role="tab" aria-controls="v-pills-laporan" aria-selected="false">
                        <i class="fas fa-file-pdf feature-icon"></i> Laporan
                    </a>
                    <a class="nav-link" id="v-pills-pengaturan-tab" data-bs-toggle="pill" href="#v-pills-pengaturan" role="tab" aria-controls="v-pills-pengaturan" aria-selected="false">
                        <i class="fas fa-cog feature-icon"></i> Pengaturan
                    </a>
                    <a class="nav-link" id="v-pills-bantuan-tab" data-bs-toggle="pill" href="#v-pills-bantuan" role="tab" aria-controls="v-pills-bantuan" aria-selected="false">
                        <i class="fas fa-question-circle feature-icon"></i> Bantuan
                    </a>
                    <hr>
                    <a class="nav-link" href="#" id="logoutBtn">
                        <i class="fas fa-sign-out-alt feature-icon"></i> Keluar
                    </a>
                </div>
                
                <!-- Developer Info DIHAPUS sesuai permintaan -->
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 p-5">
                <div class="tab-content" id="v-pills-tabContent">
                    <!-- Dashboard -->
                    <div class="tab-pane fade show active" id="v-pills-dashboard" role="tabpanel" aria-labelledby="v-pills-dashboard-tab">
                        <h2 class="section-title">Dashboard</h2>
                        
                        <div class="row">
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-users fa-2x text-primary"></i>
                                    <div class="stats-number" id="totalPenerima">0</div>
                                    <div class="stats-label">Total Penerima</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-hand-holding-usd fa-2x text-success"></i>
                                    <div class="stats-number" id="totalBantuan">0</div>
                                    <div class="stats-label">Total Bantuan</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-map-marker-alt fa-2x text-warning"></i>
                                    <div class="stats-number" id="totalKecamatan">0</div>
                                    <div class="stats-label">Kecamatan</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-calendar-alt fa-2x text-info"></i>
                                    <div class="stats-number" id="tahunAktif">2023</div>
                                    <div class="stats-label">Tahun Aktif</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2"></i> Distribusi Bantuan per Jenis
                                    </div>
                                    <div class="card-body">
                                        <canvas id="jenisBantuanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-line me-2"></i> Tren Bantuan per Bulan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="trenBantuanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-history me-2"></i> Data Terbaru
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover data-table">
                                                <thead>
                                                    <tr>
                                                        <th>Nama</th>
                                                        <th>NIK</th>
                                                        <th>WhatsApp</th>
                                                        <th>Jenis Bantuan</th>
                                                        <th>Jumlah</th>
                                                        <th>Tanggal</th>
                                                        <th>Aksi</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="recentDataTable">
                                                    <tr>
                                                        <td colspan="7" class="text-center">Tidak ada data</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Input Data -->
                    <div class="tab-pane fade" id="v-pills-input" role="tabpanel" aria-labelledby="v-pills-input-tab">
                        <h2 class="section-title">Input Data Bantuan</h2>
                        
                        <form id="inputForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">Data Penerima</div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="nama" class="form-label"><i class="fas fa-user"></i> Nama Lengkap</label>
                                                <input type="text" class="form-control" id="nama" required>
                                                <div class="error-message" id="namaError">Nama harus diisi</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="nik" class="form-label"><i class="fas fa-id-card"></i> NIK</label>
                                                <input type="text" class="form-control" id="nik" maxlength="16" required>
                                                <div class="error-message" id="nikError">NIK harus 16 digit angka</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="whatsapp" class="form-label"><i class="fab fa-whatsapp"></i> Nomor WhatsApp</label>
                                                <input type="text" class="form-control" id="whatsapp" required>
                                                <div class="error-message" id="whatsappError">Nomor WhatsApp harus valid</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="namaKelompok" class="form-label"><i class="fas fa-users"></i> Nama Kelompok (jika ada)</label>
                                                <input type="text" class="form-control" id="namaKelompok">
                                            </div>
                                            <div class="mb-3">
                                                <label for="jabatan" class="form-label"><i class="fas fa-user-tag"></i> Jabatan dalam Kelompok</label>
                                                <select class="form-select" id="jabatan">
                                                    <option value="Individu">Individu</option>
                                                    <option value="Ketua">Ketua</option>
                                                    <option value="Sekretaris">Sekretaris</option>
                                                    <option value="Bendahara">Bendahara</option>
                                                    <option value="Anggota">Anggota</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">Data Bantuan</div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="tahunAnggaran" class="form-label"><i class="fas fa-calendar"></i> Tahun Anggaran</label>
                                                <select class="form-select" id="tahunAnggaran" required>
                                                    <option value="">Pilih Tahun</option>
                                                    <!-- Options akan diisi oleh JavaScript -->
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="kecamatan" class="form-label"><i class="fas fa-map-marker-alt"></i> Kecamatan</label>
                                                <select class="form-select" id="kecamatan" required>
                                                    <option value="">Pilih Kecamatan</option>
                                                    <option value="Arjasa">Arjasa</option>
                                                    <option value="Asembagus">Asembagus</option>
                                                    <option value="Banyuglugur">Banyuglugur</option>
                                                    <option value="Banyuputih">Banyuputih</option>
                                                    <option value="Besuki">Besuki</option>
                                                    <option value="Bungatan">Bungatan</option>
                                                    <option value="Jangkar">Jangkar</option>
                                                    <option value="Jatibanteng">Jatibanteng</option>
                                                    <option value="Kapongan">Kapongan</option>
                                                    <option value="Kendit">Kendit</option>
                                                    <option value="Mangaran">Mangaran</option>
                                                    <option value="Mlandingan">Mlandingan</option>
                                                    <option value="Panarukan">Panarukan</option>
                                                    <option value="Panji">Panji</option>
                                                    <option value="Situbondo">Situbondo</option>
                                                    <option value="Suboh">Suboh</option>
                                                    <option value="Sumbermalang">Sumbermalang</option>
                                                </select>
                                                <div class="error-message" id="kecamatanError">Kecamatan harus dipilih</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="desa" class="form-label"><i class="fas fa-map-pin"></i> Desa/Kelurahan</label>
                                                <select class="form-select" id="desa" required>
                                                    <option value="">Pilih Desa</option>
                                                    <!-- Options akan diisi secara dinamis berdasarkan pilihan kecamatan -->
                                                </select>
                                                <div class="error-message" id="desaError">Desa harus dipilih</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="alamat" class="form-label"><i class="fas fa-home"></i> Alamat Lengkap</label>
                                                <textarea class="form-control" id="alamat" rows="2"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">Detail Bantuan</div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="jenisBantuan" class="form-label"><i class="fas fa-gift"></i> Jenis Bantuan</label>
                                                <select class="form-select" id="jenisBantuan" required>
                                                    <option value="">Pilih Jenis Bantuan</option>
                                                    <option value="Tunai">Tunai</option>
                                                    <option value="Beras">Beras</option>
                                                    <option value="Pupuk">Pupuk</option>
                                                    <option value="Bibit">Bibit</option>
                                                    <option value="Peralatan">Peralatan</option>
                                                    <option value="Lainnya">Lainnya</option>
                                                </select>
                                                <div class="error-message" id="jenisBantuanError">Jenis bantuan harus dipilih</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="namaBantuan" class="form-label"><i class="fas fa-tag"></i> Nama Bantuan (jika ada)</label>
                                                <input type="text" class="form-control" id="namaBantuan">
                                            </div>
                                            <div class="mb-3">
                                                <label for="jumlahBantuan" class="form-label"><i class="fas fa-calculator"></i> Jumlah Bantuan</label>
                                                <input type="number" class="form-control" id="jumlahBantuan" min="1" required>
                                                <div class="error-message" id="jumlahBantuanError">Jumlah bantuan harus diisi</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="satuanBantuan" class="form-label"><i class="fas fa-balance-scale"></i> Satuan</label>
                                                <select class="form-select" id="satuanBantuan" required>
                                                    <option value="">Pilih Satuan</option>
                                                    <option value="Rupiah">Rupiah</option>
                                                    <option value="Kg">Kilogram</option>
                                                    <option value="Karung">Karung</option>
                                                    <option value="Paket">Paket</option>
                                                    <option value="Unit">Unit</option>
                                                    <option value="Lainnya">Lainnya</option>
                                                </select>
                                                <div class="error-message" id="satuanBantuanError">Satuan harus dipilih</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">Informasi Tambahan</div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="tanggalTerima" class="form-label"><i class="fas fa-calendar-day"></i> Tanggal Penerimaan</label>
                                                <input type="date" class="form-control" id="tanggalTerima" required>
                                                <div class="error-message" id="tanggalTerimaError">Tanggal harus diisi</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="namaPetugas" class="form-label"><i class="fas fa-user-check"></i> Nama Petugas Penyalur</label>
                                                <input type="text" class="form-control" id="namaPetugas">
                                            </div>
                                            <div class="mb-3">
                                                <label for="driveLink" class="form-label"><i class="fas fa-link"></i> Link Google Drive (jika ada)</label>
                                                <input type="url" class="form-control" id="driveLink" placeholder="https://drive.google.com/...">
                                            </div>
                                            <div class="mb-3">
                                                <label for="kodeValidasi" class="form-label"><i class="fas fa-key"></i> Kode Validasi</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="kodeValidasi" required>
                                                    <button class="btn btn-outline-secondary" type="button" id="generateCodeBtn">
                                                        <i class="fas fa-sync-alt"></i> Generate
                                                    </button>
                                                </div>
                                                <div class="error-message" id="kodeValidasiError">Kode validasi harus diisi</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="keterangan" class="form-label"><i class="fas fa-sticky-note"></i> Keterangan Tambahan</label>
                                                <textarea class="form-control" id="keterangan" rows="2"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="reset" class="btn btn-secondary me-md-2">
                                    <i class="fas fa-undo me-1"></i> Reset
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save me-1"></i> Simpan Data
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Data Bantuan -->
                    <div class="tab-pane fade" id="v-pills-data" role="tabpanel" aria-labelledby="v-pills-data-tab">
                        <h2 class="section-title">Data Bantuan</h2>
                        
                        <div class="filter-section">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filterTahun" class="form-label">Tahun</label>
                                        <select class="form-select" id="filterTahun">
                                            <option value="all">Semua Tahun</option>
                                            <!-- Options akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filterKecamatan" class="form-label">Kecamatan</label>
                                        <select class="form-select" id="filterKecamatan">
                                            <option value="all">Semua Kecamatan</option>
                                            <option value="Arjasa">Arjasa</option>
                                            <option value="Asembagus">Asembagus</option>
                                            <option value="Banyuglugur">Banyuglugur</option>
                                            <option value="Banyuputih">Banyuputih</option>
                                            <option value="Besuki">Besuki</option>
                                            <option value="Bungatan">Bungatan</option>
                                            <option value="Jangkar">Jangkar</option>
                                            <option value="Jatibanteng">Jatibanteng</option>
                                            <option value="Kapongan">Kapongan</option>
                                            <option value="Kendit">Kendit</option>
                                            <option value="Mangaran">Mangaran</option>
                                            <option value="Mlandingan">Mlandingan</option>
                                            <option value="Panarukan">Panarukan</option>
                                            <option value="Panji">Panji</option>
                                            <option value="Situbondo">Situbondo</option>
                                            <option value="Suboh">Suboh</option>
                                            <option value="Sumbermalang">Sumbermalang</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filterJenis" class="form-label">Jenis Bantuan</label>
                                        <select class="form-select" id="filterJenis">
                                            <option value="all">Semua Jenis</option>
                                            <option value="Tunai">Tunai</option>
                                            <option value="Beras">Beras</option>
                                            <option value="Pupuk">Pupuk</option>
                                            <option value="Bibit">Bibit</option>
                                            <option value="Peralatan">Peralatan</option>
                                            <option value="Lainnya">Lainnya</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="searchInput" class="form-label">Pencarian</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="searchInput" placeholder="Cari data...">
                                            <button class="btn btn-outline-secondary" type="button" id="clearSearchBtn">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-between">
                                <div>
                                    <button class="btn btn-sm btn-outline-primary" id="applyFilterBtn">
                                        <i class="fas fa-filter me-1"></i> Terapkan Filter
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary ms-2" id="resetFilterBtn">
                                        <i class="fas fa-redo me-1"></i> Reset
                                    </button>
                                </div>
                                <div>
                                    <span class="badge bg-primary" id="totalRecords">0 Data</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="control-panel">
                            <div class="control-title">Kontrol Data</div>
                            <div class="d-flex flex-wrap gap-2">
                                <button class="btn btn-sm btn-success" id="exportExcelBtn">
                                    <i class="fas fa-file-excel me-1"></i> Export Excel
                                </button>
                                <button class="btn btn-sm btn-danger" id="exportPdfBtn">
                                    <i class="fas fa-file-pdf me-1"></i> Export PDF
                                </button>
                                <button class="btn btn-sm btn-warning" id="printDataBtn">
                                    <i class="fas fa-print me-1"></i> Cetak
                                </button>
                                <button class="btn btn-sm btn-info" id="importDataBtn">
                                    <i class="fas fa-file-import me-1"></i> Import Data
                                </button>
                                <button class="btn btn-sm btn-secondary" id="backupDataBtn">
                                    <i class="fas fa-download me-1"></i> Backup
                                </button>
                                <button class="btn btn-sm btn-dark" id="restoreDataBtn">
                                    <i class="fas fa-upload me-1"></i> Restore
                                </button>
                                <button class="btn btn-sm btn-outline-danger" id="deleteAllBtn">
                                    <i class="fas fa-trash me-1"></i> Hapus Semua
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-responsive mt-4">
                            <table class="table table-striped table-bordered table-hover data-table" id="mainDataTable">
                                <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>Nama</th>
                                        <th>NIK</th>
                                        <th>WhatsApp</th>
                                        <th>Kecamatan</th>
                                        <th>Desa</th>
                                        <th>Jenis Bantuan</th>
                                        <th>Jumlah</th>
                                        <th>Tanggal</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="dataTableBody">
                                    <tr>
                                        <td colspan="10" class="text-center">Tidak ada data</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <div class="form-group d-flex align-items-center">
                                <label for="itemsPerPageSelect" class="me-2 mb-0">Baris per halaman:</label>
                                <select class="form-select form-select-sm" id="itemsPerPageSelect" style="width: 80px;">
                                    <option value="10">10</option>
                                    <option value="25" selected>25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                            <nav>
                                <ul class="pagination pagination-sm" id="pagination">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#" tabindex="-1">Previous</a>
                                    </li>
                                    <li class="page-item active">
                                        <a class="page-link" href="#">1</a>
                                    </li>
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#">Next</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- Statistik -->
                    <div class="tab-pane fade" id="v-pills-statistik" role="tabpanel" aria-labelledby="v-pills-statistik-tab">
                        <h2 class="section-title">Statistik Bantuan</h2>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card mb-4">
                                    <div class="card-header">Filter Statistik</div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label for="statTahun" class="form-label">Tahun</label>
                                            <select class="form-select" id="statTahun">
                                                <option value="all">Semua Tahun</option>
                                                <!-- Options akan diisi oleh JavaScript -->
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="statKecamatan" class="form-label">Kecamatan</label>
                                            <select class="form-select" id="statKecamatan">
                                                <option value="all">Semua Kecamatan</option>
                                                <option value="Arjasa">Arjasa</option>
                                                <option value="Asembagus">Asembagus</option>
                                                <option value="Banyuglugur">Banyuglugur</option>
                                                <option value="Banyuputih">Banyuputih</option>
                                                <option value="Besuki">Besuki</option>
                                                <option value="Bungatan">Bungatan</option>
                                                <option value="Jangkar">Jangkar</option>
                                                <option value="Jatibanteng">Jatibanteng</option>
                                                <option value="Kapongan">Kapongan</option>
                                                <option value="Kendit">Kendit</option>
                                                <option value="Mangaran">Mangaran</option>
                                                <option value="Mlandingan">Mlandingan</option>
                                                <option value="Panarukan">Panarukan</option>
                                                <option value="Panji">Panji</option>
                                                <option value="Situbondo">Situbondo</option>
                                                <option value="Suboh">Suboh</option>
                                                <option value="Sumbermalang">Sumbermalang</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="statJenis" class="form-label">Jenis Bantuan</label>
                                            <select class="form-select" id="statJenis">
                                                <option value="all">Semua Jenis</option>
                                                <option value="Tunai">Tunai</option>
                                                <option value="Beras">Beras</option>
                                                <option value="Pupuk">Pupuk</option>
                                                <option value="Bibit">Bibit</option>
                                                <option value="Peralatan">Peralatan</option>
                                                <option value="Lainnya">Lainnya</option>
                                            </select>
                                        </div>
                                        <button class="btn btn-primary w-100" id="applyStatFilterBtn">
                                            <i class="fas fa-filter me-1"></i> Terapkan Filter
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-8">
                                <div class="card mb-4">
                                    <div class="card-header">Distribusi per Kecamatan</div>
                                    <div class="card-body">
                                        <canvas id="kecamatanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">Perbandingan Tahun</div>
                                    <div class="card-body">
                                        <canvas id="tahunComparisonChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">Top 10 Desa Penerima</div>
                                    <div class="card-body">
                                        <canvas id="desaChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-header">Rekap Data Statistik</div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Kecamatan</th>
                                                        <th>Jumlah Penerima</th>
                                                        <th>Tunai</th>
                                                        <th>Beras</th>
                                                        <th>Pupuk</th>
                                                        <th>Bibit</th>
                                                        <th>Peralatan</th>
                                                        <th>Lainnya</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="statistikTableBody">
                                                    <tr>
                                                        <td colspan="8" class="text-center">Tidak ada data</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Laporan -->
                    <div class="tab-pane fade" id="v-pills-laporan" role="tabpanel" aria-labelledby="v-pills-laporan-tab">
                        <h2 class="section-title">Laporan dan Ekspor Data</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">Buat Laporan</div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label for="reportType" class="form-label">Jenis Laporan</label>
                                            <select class="form-select" id="reportType">
                                                <option value="all">Semua Data</option>
                                                <option value="yearly">Per Tahun</option>
                                                <option value="monthly">Per Bulan</option>
                                                <option value="kecamatan">Per Kecamatan</option>
                                                <option value="jenis">Per Jenis Bantuan</option>
                                            </select>
                                        </div>
                                        <div class="mb-3" id="yearSelection">
                                            <label for="reportYear" class="form-label">Tahun</label>
                                            <select class="form-select" id="reportYear">
                                                <!-- Options akan diisi oleh JavaScript -->
                                            </select>
                                        </div>
                                        <div class="mb-3 d-none" id="monthSelection">
                                            <label for="reportMonth" class="form-label">Bulan</label>
                                            <select class="form-select" id="reportMonth">
                                                <option value="01">Januari</option>
                                                <option value="02">Februari</option>
                                                <option value="03">Maret</option>
                                                <option value="04">April</option>
                                                <option value="05">Mei</option>
                                                <option value="06">Juni</option>
                                                <option value="07">Juli</option>
                                                <option value="08">Agustus</option>
                                                <option value="09">September</option>
                                                <option value="10">Oktober</option>
                                                <option value="11">November</option>
                                                <option value="12">Desember</option>
                                            </select>
                                        </div>
                                        <div class="mb-3 d-none" id="kecamatanSelection">
                                            <label for="reportKecamatan" class="form-label">Kecamatan</label>
                                            <select class="form-select" id="reportKecamatan">
                                                <option value="Arjasa">Arjasa</option>
                                                <option value="Asembagus">Asembagus</option>
                                                <option value="Banyuglugur">Banyuglugur</option>
                                                <option value="Banyuputih">Banyuputih</option>
                                                <option value="Besuki">Besuki</option>
                                                <option value="Bungatan">Bungatan</option>
                                                <option value="Jangkar">Jangkar</option>
                                                <option value="Jatibanteng">Jatibanteng</option>
                                                <option value="Kapongan">Kapongan</option>
                                                <option value="Kendit">Kendit</option>
                                                <option value="Mangaran">Mangaran</option>
                                                <option value="Mlandingan">Mlandingan</option>
                                                <option value="Panarukan">Panarukan</option>
                                                <option value="Panji">Panji</option>
                                                <option value="Situbondo">Situbondo</option>
                                                <option value="Suboh">Suboh</option>
                                                <option value="Sumbermalang">Sumbermalang</option>
                                            </select>
                                        </div>
                                        <div class="mb-3 d-none" id="jenisSelection">
                                            <label for="reportJenis" class="form-label">Jenis Bantuan</label>
                                            <select class="form-select" id="reportJenis">
                                                <option value="Tunai">Tunai</option>
                                                <option value="Beras">Beras</option>
                                                <option value="Pupuk">Pupuk</option>
                                                <option value="Bibit">Bibit</option>
                                                <option value="Peralatan">Peralatan</option>
                                                <option value="Lainnya">Lainnya</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="reportFormat" class="form-label">Format Laporan</label>
                                            <select class="form-select" id="reportFormat">
                                                <option value="pdf">PDF</option>
                                                <option value="excel">Excel</option>
                                                <option value="print">Cetak Langsung</option>
                                            </select>
                                        </div>
                                        <button class="btn btn-primary w-100" id="generateReportBtn">
                                            <i class="fas fa-file-export me-1"></i> Buat Laporan
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">Template Laporan</div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label class="form-label">Pilih Template</label>
                                            <div class="list-group">
                                                <a href="#" class="list-group-item list-group-item-action">
                                                    <div class="d-flex w-100 justify-content-between">
                                                        <h6 class="mb-1">Laporan Bulanan Standar</h6>
                                                        <small class="text-muted">PDF</small>
                                                    </div>
                                                    <p class="mb-1 small">Laporan ringkasan data bantuan per bulan</p>
                                                </a>
                                                <a href="#" class="list-group-item list-group-item-action">
                                                    <div class="d-flex w-100 justify-content-between">
                                                        <h6 class="mb-1">Laporan Tahunan Komprehensif</h6>
                                                        <small class="text-muted">Excel</small>
                                                    </div>
                                                    <p class="mb-1 small">Laporan detail semua data per tahun</p>
                                                </a>
                                                <a href="#" class="list-group-item list-group-item-action">
                                                    <div class="d-flex w-100 justify-content-between">
                                                        <h6 class="mb-1">Laporan per Kecamatan</h6>
                                                        <small class="text-muted">PDF</small>
                                                    </div>
                                                    <p class="mb-1 small">Distribusi bantuan per kecamatan</p>
                                                </a>
                                                <a href="#" class="list-group-item list-group-item-action">
                                                    <div class="d-flex w-100 justify-content-between">
                                                        <h6 class="mb-1">Laporan per Jenis Bantuan</h6>
                                                        <small class="text-muted">Excel</small>
                                                    </div>
                                                    <p class="mb-1 small">Statistik bantuan berdasarkan jenis</p>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">Riwayat Laporan</div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Tanggal</th>
                                                <th>Jenis Laporan</th>
                                                <th>Parameter</th>
                                                <th>Format</th>
                                                <th>Aksi</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="5" class="text-center">Belum ada riwayat laporan</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            </div>
                    </div>
                    
                    <!-- Pengaturan -->
                    <div class="tab-pane fade" id="v-pills-pengaturan" role="tabpanel" aria-labelledby="v-pills-pengaturan-tab">
                        <h2 class="section-title">Pengaturan Aplikasi</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">Pengaturan Umum</div>
                                    <div class="card-body">
                                        <form id="settingsForm">
                                            <div class="mb-3">
                                                <label for="appName" class="form-label">Nama Aplikasi</label>
                                                <input type="text" class="form-control" id="appName" value="BARJAS">
                                            </div>
                                            <div class="mb-3">
                                                <label for="appSubtitle" class="form-label">Subjudul Aplikasi</label>
                                                <input type="text" class="form-control" id="appSubtitle" value="Sistem Bantuan Terpadu">
                                            </div>
                                            <div class="mb-3">
                                                <label for="defaultTahun" class="form-label">Tahun Default</label>
                                                <select class="form-select" id="defaultTahun">
                                                    <!-- Options akan diisi oleh JavaScript -->
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="itemsPerPage" class="form-label">Item per Halaman</label>
                                                <select class="form-select" id="itemsPerPage">
                                                    <option value="10">10</option>
                                                    <option value="25" selected>25</option>
                                                    <option value="50">50</option>
                                                    <option value="100">100</option>
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="backupInterval" class="form-label">Interval Backup (hari)</label>
                                                <input type="number" class="form-control" id="backupInterval" value="7" min="1">
                                            </div>
                                            <div class="mb-3 form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="autoSave" checked>
                                                <label class="form-check-label" for="autoSave">Auto-save Data</label>
                                            </div>
                                            <div class="mb-3 form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="notifications" checked>
                                                <label class="form-check-label" for="notifications">Notifikasi</label>
                                            </div>
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-save me-1"></i> Simpan Pengaturan
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">Keamanan</div>
                                    <div class="card-body">
                                        <form id="securityForm">
                                            <div class="mb-3">
                                                <label for="securityCode" class="form-label">Kode Keamanan</label>
                                                <input type="password" class="form-control" id="securityCode" value="1234">
                                                <div class="form-text">Kode ini digunakan untuk akses ke fitur sensitif</div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="newPassword" class="form-label">Password Baru</label>
                                                <input type="password" class="form-control" id="newPassword">
                                            </div>
                                            <div class="mb-3">
                                                <label for="confirmPassword" class="form-label">Konfirmasi Password</label>
                                                <input type="password" class="form-control" id="confirmPassword">
                                                <div class="error-message" id="passwordError">Password tidak cocok</div>
                                            </div>
                                                                                      <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-lock me-1"></i> Update Keamanan
                                            </button>
                                        </form>
                                    </div>
                                </div>
                                
                                <div class="card mb-4">
                                    <div class="card-header">Pemeliharaan</div>
                                    <div class="card-body">
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-outline-secondary" id="clearCacheBtn">
                                                <i class="fas fa-broom me-1"></i> Bersihkan Cache
                                            </button>
                                            <button class="btn btn-outline-info" id="checkUpdateBtn">
                                                <i class="fas fa-sync-alt me-1"></i> Periksa Pembaruan
                                            </button>
                                            <button class="btn btn-outline-warning" id="rebuildIndexBtn">
                                                <i class="fas fa-database me-1"></i> Perbaiki Index Data
                                            </button>
                                            <button class="btn btn-outline-danger" id="resetAppBtn">
                                                <i class="fas fa-trash-alt me-1"></i> Reset Aplikasi
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card">
                                    <div class="card-header">Info Aplikasi</div>
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <strong>Versi:</strong> 1.2.0
                                        </div>
                                        <div class="mb-2">
                                            <strong>Terakhir Diperbarui:</strong> 15 Desember 2023
                                        </div>
                                        <div class="mb-2">
                                            <strong>Ukuran Database:</strong> <span id="dbSize">0 MB</span>
                                        </div>
                                        <div class="mb-2">
                                            <strong>Total Data:</strong> <span id="totalDataSettings">0</span> records
                                        </div>
                                        <div class="mb-2">
                                            <strong>Browser:</strong> <span id="browserInfo"></span>
                                        </div>
                                        <div class="mb-2">
                                            <strong>LocalStorage:</strong> <span id="localStorageStatus">Supported</span>
                                        </div>
                                        <hr>
                                        <div class="text-center">
                                            <button class="btn btn-sm btn-outline-primary" id="aboutBtn">
                                                <i class="fas fa-info-circle me-1"></i> Tentang Aplikasi
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bantuan -->
                    <div class="tab-pane fade" id="v-pills-bantuan" role="tabpanel" aria-labelledby="v-pills-bantuan-tab">
                        <h2 class="section-title">Bantuan dan Panduan</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">Panduan Penggunaan</div>
                                    <div class="card-body">
                                        <div class="accordion" id="helpAccordion">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header">
                                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#helpOne">
                                                        Cara Input Data
                                                    </button>
                                                </h2>
                                                <div id="helpOne" class="accordion-collapse collapse show" data-bs-parent="#helpAccordion">
                                                    <div class="accordion-body">
                                                        <ol>
                                                            <li>Buka menu <strong>Input Data</strong></li>
                                                            <li>Isi semua field yang wajib diisi (ditandai dengan *)</li>
                                                            <li>Klik tombol <strong>Generate</strong> untuk kode validasi</li>
                                                            <li>Tekan tombol <strong>Simpan Data</strong> untuk menyimpan</li>
                                                        </ol>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="accordion-item">
                                                <h2 class="accordion-header">
                                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#helpTwo">
                                                        Cara Filter Data
                                                    </button>
                                                </h2>
                                                <div id="helpTwo" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                                    <div class="accordion-body">
                                                        <p>Anda dapat memfilter data berdasarkan:</p>
                                                        <ul>
                                                            <li>Tahun anggaran</li>
                                                            <li>Kecamatan</li>
                                                            <li>Jenis bantuan</li>
                                                            <li>Kata kunci pencarian</li>
                                                        </ul>
                                                        <p>Gunakan tombol <strong>Terapkan Filter</strong> untuk menerapkan filter yang dipilih.</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="accordion-item">
                                                <h2 class="accordion-header">
                                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#helpThree">
                                                        Cara Ekspor Data
                                                    </button>
                                                </h2>
                                                <div id="helpThree" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                                    <div class="accordion-body">
                                                        <p>Data dapat diekspor dalam format:</p>
                                                        <ul>
                                                            <li><strong>Excel</strong> - untuk analisis data lebih lanjut</li>
                                                            <li><strong>PDF</strong> - untuk laporan dan dokumentasi</li>
                                                            <li><strong>Cetak</strong> - untuk mencetak langsung</li>
                                                        </ul>
                                                        <p>Pilih format yang diinginkan lalu klik tombol ekspor yang sesuai.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card mb-4">
                                    <div class="card-header">Video Tutorial</div>
                                    <div class="card-body">
                                        <div class="text-center p-3 bg-light rounded">
                                            <i class="fas fa-video fa-3x text-secondary mb-3"></i>
                                            <p>Video tutorial akan segera tersedia</p>
                                            <button class="btn btn-outline-primary btn-sm" disabled>
                                                <i class="fas fa-play-circle me-1"></i> Putar Tutorial
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">FAQ (Pertanyaan Umum)</div>
                                    <div class="card-body">
                                        <div class="accordion" id="faqAccordion">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header">
                                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faqOne">
                                                        Bagaimana cara backup data?
                                                    </button>
                                                </h2>
                                                <div id="faqOne" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                                                    <div class="accordion-body">
                                                        Untuk backup data, buka menu <strong>Data Bantuan</strong> lalu klik tombol <strong>Backup</strong>. File backup akan diunduh secara otomatis.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="accordion-item">
                                                <h2 class="accordion-header">
                                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqTwo">
                                                        Apa fungsi kode validasi?
                                                    </button>
                                                </h2>
                                                <div id="faqTwo" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                                    <div class="accordion-body">
                                                        Kode validasi digunakan untuk memverifikasi keaslian data dan mencegah duplikasi. Kode ini digenerate secara otomatis dan unik untuk setiap entri data.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="accordion-item">
                                                <h2 class="accordion-header">
                                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqThree">
                                                        Data saya hilang, bagaimana mengembalikannya?
                                                    </button>
                                                </h2>
                                                <div id="faqThree" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                                    <div class="accordion-body">
                                                        Jika Anda telah melakukan backup sebelumnya, Anda dapat mengembalikan data dengan menggunakan fitur <strong>Restore</strong> di menu Data Bantuan. Jika tidak, hubungi developer untuk bantuan lebih lanjut.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card">
                                    <div class="card-header">Dukungan Teknis</div>
                                    <div class="card-body">
                                        <p>Untuk bantuan teknis dan pertanyaan lebih lanjut, hubungi:</p>
                                        <div class="developer-info">
                                            <h6>Developer Support</h6>
                                            <div class="developer-contact">
                                                <p><i class="fas fa-envelope me-2"></i> Email: support@barjas.app</p>
                                                <p><i class="fab fa-whatsapp me-2"></i> WhatsApp: +62 812-3456-7890</p>
                                                <p><i class="fas fa-clock me-2"></i> Waktu Respons: 1-2 hari kerja</p>
                                            </div>
                                        </div>
                                        <div class="text-center mt-3">
                                            <button class="btn btn-outline-success me-2" id="contactSupportBtn">
                                                <i class="fas fa-headset me-1"></i> Hubungi Support
                                            </button>
                                            <button class="btn btn-outline-info" id="requestFeatureBtn">
                                                <i class="fas fa-lightbulb me-1"></i> Request Fitur
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            &copy; 2023 BARJAS - Sistem Bantuan Terpadu. All rights reserved.
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <div class="floating-action-btn" id="fabButton">
        <i class="fas fa-plus"></i>
    </div>
    
    <!-- Notification Toast -->
    <div class="toast notification-toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="5000">
        <div class="toast-header">
            <strong class="me-auto" id="toastTitle">Notification</strong>
            <small id="toastTime">Just now</small>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" id="toastMessage">
            Operation completed successfully.
        </div>
    </div>
    
    <!-- Welcome Modal -->
    <div class="modal fade welcome-modal" id="welcomeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="welcome-header">
                    <i class="fas fa-hands-helping welcome-icon"></i>
                    <h3 class="welcome-title">Selamat Datang di BARJAS</h3>
                </div>
                <div class="welcome-body">
                    <h5>Sistem Bantuan Terpadu</h5>
                    <p>Aplikasi untuk mengelola data bantuan dengan mudah dan efisien.</p>
                    <div class="countdown-timer">
                        Aplikasi siap digunakan dalam: <span id="countdown">5</span> detik
                    </div>
                </div>
                <div class="welcome-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="skipCountdownBtn">
                        Lewati dan Mulai Sekarang
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div class="modal fade login-modal" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="login-header">
                    <i class="fas fa-lock login-icon"></i>
                    <h3 class="login-title">Akses Terkunci</h3>
                    <p class="login-subtitle">Masukkan kode keamanan untuk melanjutkan</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="login-form-group">
                            <label for="loginPassword" class="login-form-label">
                                <i class="fas fa-key"></i> Kode Keamanan
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control login-form-control" id="loginPassword" placeholder="Masukkan kode keamanan" required>
                                <span class="input-group-text" id="togglePassword">
                                    <i class="fas fa-eye"></i>
                                </span>
                            </div>
                        </div>
                        
                        <div id="loginError" class="alert alert-danger d-none" role="alert">
                            <i class="fas fa-exclamation-circle me-2"></i> Kode keamanan salah!
                        </div>
                        
                        <div id="loginAttempts" class="login-attempts-count d-none">
                            Percobaan tersisa: <span id="attemptsCount">3</span>
                        </div>
                        
                        <div id="loginBlocked" class="login-blocked-message d-none">
                            <i class="fas fa-ban me-2"></i> Akses diblokir selama <span id="blockTime">5</span> menit
                        </div>
                        
                        <button type="submit" class="btn btn-login" id="loginSubmitBtn">
                            <span class="spinner-border spinner-border-sm d-none" id="loginSpinner" role="status" aria-hidden="true"></span>
                            <i class="fas fa-unlock-alt me-2 d-none" id="loginIcon"></i>
                            <span id="loginText">Masuk</span>
                        </button>
                    </form>
                    
                    <div class="login-security-notice">
                        <i class="fas fa-info-circle me-2"></i> Hubungi administrator jika lupa kode keamanan
                    </div>                 
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Main Application Script -->
    <script>
        // Inisialisasi variabel global
        let bantuanData = JSON.parse(localStorage.getItem('bantuanData')) || [];
        let loginAttempts = parseInt(localStorage.getItem('loginAttempts')) || 0;
        let isBlocked = localStorage.getItem('isBlocked') === 'true';
        let blockedUntil = parseInt(localStorage.getItem('blockedUntil')) || 0;
        const CORRECT_CODE = "123456"; // Kode keamanan default
        
        // Daftar desa yang diminta
        const desaList = [
            "Agel", "Alas Bayur", "Alasmalang", "Alastengah", "Arjasa", "Ardirejo", "Asembagus", 
            "Awar-awar", "Awang-awang", "Baderan", "Balung", "Bantal", "Battal", "Bayeman", "Besuki", "Bletok", "Blimbing", "Bloro", "Buduan", "Bugeman", "Bungatan", 
            "Campoan", "Cemara", "Curah Cottok", "Curah Jeru", "Curah Kalak", "Curah Suri", "Curah Tatal", "Dawuhan", "Demung", "Duwet", "Gadingan", "Gebangan", 
            "Gelung", "Gudang", "Gunung Malang", "Gunung Putri", "Jangkar", "Jatisari", "Jatibanteng", "Jetis", "Juglangan", "Kalianget", "Kalibagor", "Kalimas", 
            "Kalirejo", "Kalisari", "Kandang", "Kayu Putih", "Kayumas", "Kedungdowo", "Kedunglo", "Kembangsari", "Ketah", "Ketowan", "Kilensari", "Klampokan", 
            "Klatakan", "Kotakan", "Kumbangsari", "Kukusan", "Lamongan", "Landangan", "Langkap", "Lebeng", "Lubawang", "Mangaran", "Mimbaan", "Mlandingan Kulon", 
            "Mlandingan Wetan", "Mojodungkol", "Mojosari", "Olean", "Palangan", "Panarukan", "Panji Kidul", "Panji Lor", "Parante", "Pasir Putih", "Patemon", 
            "Patokan", "Paowan", "Peleyan", "Pesisir", "Pesanggrahan", "Pategalan", "Patemon", "Plalangan", "Pokaan", "Rajekwesi", "Seletreng", "Selobanteng", 
            "Selomukti", "Selowogo", "Semambung", "Semiring", "Sliwung", "Sopet", "Sumber Pinang", "Sumberanyar", "Sumberargo", "Sumberkolak", "Sumberejo", 
            "Sumbertengah", "Sumberwaru", "Tamankursi", "Tamansari", "Taman", "Talkandang", "Tanjung Glugur", "Tanjung Kamal", "Tanjung Pecinan", "Tambak Ukir", 
            "Telempong", "Tenggir", "Tepos", "Tokelan", "Tlogosari", "Trigonco", "Trebungan", "Widoropayung", "Wonokoyo", "Wonorejo", "Wringinanom"
        ];
        
        // DOM Elements
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const sidebarMenu = document.getElementById('sidebarMenu');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const loginModalElement = document.getElementById('loginModal');
        const loginModal = new bootstrap.Modal(loginModalElement);
        const welcomeModal = new bootstrap.Modal(document.getElementById('welcomeModal'));
        const toast = new bootstrap.Toast(document.getElementById('notificationToast'));
        
        // Toggle mobile menu
        function toggleMobileMenu() {
            sidebarMenu.classList.toggle('mobile-show');
            sidebarOverlay.classList.toggle('mobile-show');
        }
        
        // Event Listeners
        mobileMenuBtn.addEventListener('click', toggleMobileMenu);
        sidebarOverlay.addEventListener('click', toggleMobileMenu);
        
        // Check authentication on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is authenticated
            const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';
            
            // Check if user is blocked
            const now = Date.now();
            if (isBlocked && now < blockedUntil) {
                // User is still blocked
                showLoginModal();
                const remainingTime = Math.ceil((blockedUntil - now) / 1000);
                startCountdown(remainingTime);
            } else if (isBlocked && now >= blockedUntil) {
                // Block period is over, reset attempts
                resetLoginAttempts();
            }
            
            if (!isAuthenticated) {
                showLoginModal();
            } else {
                // User is authenticated, initialize the app
                initApp();
                
                // Show welcome modal on first visit
                const firstVisit = localStorage.getItem('firstVisit');
                if (!firstVisit) {
                    setTimeout(() => {
                        welcomeModal.show();
                        localStorage.setItem('firstVisit', 'true');
                    }, 1000);
                }
            }
            
            // Setup login form
            setupLoginForm();
            
            // Setup other event listeners
            setupEventListeners();
            
            // Initialize charts
            initCharts();
        });
        
        // Show login modal
        function showLoginModal() {
            loginModal.show();
        }
        
        // Setup login form
        function setupLoginForm() {
            const loginForm = document.getElementById('loginForm');
            const loginPassword = document.getElementById('loginPassword');
            const togglePassword = document.getElementById('togglePassword');
            const loginError = document.getElementById('loginError');
            const loginAttemptsElement = document.getElementById('loginAttempts');
            const attemptsCount = document.getElementById('attemptsCount');
            const loginBlocked = document.getElementById('loginBlocked');
            const blockTime = document.getElementById('blockTime');
            const loginSubmitBtn = document.getElementById('loginSubmitBtn');
            const loginSpinner = document.getElementById('loginSpinner');
            const loginIcon = document.getElementById('loginIcon');
            const loginText = document.getElementById('loginText');
            
            // Update attempts count
            attemptsCount.textContent = 3 - loginAttempts;
            
            // Show/hide password
            togglePassword.addEventListener('click', function() {
                if (loginPassword.type === 'password') {
                    loginPassword.type = 'text';
                    togglePassword.innerHTML = '<i class="fas fa-eye-slash"></i>';
                } else {
                    loginPassword.type = 'password';
                    togglePassword.innerHTML = '<i class="fas fa-eye"></i>';
                }
            });
            
            // Check if user is blocked
            const now = Date.now();
            if (isBlocked && now < blockedUntil) {
                const remainingTime = Math.ceil((blockedUntil - now) / 1000);
                startCountdown(remainingTime);
                return;
            } else if (isBlocked && now >= blockedUntil) {
                resetLoginAttempts();
            }
            
            // Show attempts if any
            if (loginAttempts > 0) {
                loginAttemptsElement.classList.remove('d-none');
                attemptsCount.textContent = 3 - loginAttempts;
            }
            
            // Handle login form submission
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const accessCode = loginPassword.value;
                
                // Show loading state
                loginSpinner.classList.remove('d-none');
                loginIcon.classList.add('d-none');
                loginText.textContent = 'Memproses...';
                loginSubmitBtn.disabled = true;
                
                // Simulate login process
                setTimeout(() => {
                    // Default access code is 123456
                    if (accessCode === CORRECT_CODE) {
                        // Successful login
                        localStorage.setItem('isAuthenticated', 'true');
                        resetLoginAttempts();
                        loginModal.hide();
                        initApp();
                        
                        // Show success notification
                        showNotification('Login berhasil', 'Selamat datang di aplikasi BARJAS', 'success');
                        
                        // Show welcome modal on first login
                        const firstVisit = localStorage.getItem('firstVisit');
                        if (!firstVisit) {
                            setTimeout(() => {
                                welcomeModal.show();
                                localStorage.setItem('firstVisit', 'true');
                            }, 500);
                        }
                    } else {
                        // Failed login
                        loginAttempts++;
                        localStorage.setItem('loginAttempts', loginAttempts);
                        
                        // Show error message
                        loginError.classList.remove('d-none');
                        loginPassword.classList.add('input-error');
                        
                        // Update attempts count
                        attemptsCount.textContent = 3 - loginAttempts;
                        loginAttemptsElement.classList.remove('d-none');
                        
                        if (loginAttempts >= 3) {
                            // Block access for 5 minutes
                            isBlocked = true;
                            blockedUntil = Date.now() + 300000; // 5 minutes
                            localStorage.setItem('isBlocked', 'true');
                            localStorage.setItem('blockedUntil', blockedUntil);
                            
                            // Show blocked message
                            loginAttemptsElement.classList.add('d-none');
                            loginBlocked.classList.remove('d-none');
                            loginSubmitBtn.disabled = true;
                            
                            // Start countdown
                            startCountdown(300);
                        } else {
                            // Show error message
                            showNotification('Login gagal', 'Kode keamanan salah. Silakan coba lagi.', 'error');
                        }
                    }
                    
                    // Reset button state
                    loginSpinner.classList.add('d-none');
                    loginIcon.classList.remove('d-none');
                    loginText.textContent = 'Masuk';
                    loginSubmitBtn.disabled = false;
                    loginPassword.value = '';
                }, 1000);
            });
        }
        
        // Start countdown for blocked access
        function startCountdown(seconds) {
            const countdownElement = document.getElementById('blockTime');
            const loginSubmitBtn = document.getElementById('loginSubmitBtn');
            
            let remaining = seconds;
            countdownElement.textContent = Math.ceil(remaining / 60);
            
            const countdownInterval = setInterval(() => {
                remaining -= 1;
                countdownElement.textContent = Math.ceil(remaining / 60);
                
                if (remaining <= 0) {
                    clearInterval(countdownInterval);
                    resetLoginAttempts();
                    
                    // Hide blocked message and show attempts count
                    document.getElementById('loginBlocked').classList.add('d-none');
                    document.getElementById('loginAttempts').classList.remove('d-none');
                    loginSubmitBtn.disabled = false;
                }
            }, 1000);
        }
        
        // Reset login attempts
        function resetLoginAttempts() {
            loginAttempts = 0;
            isBlocked = false;
            blockedUntil = 0;
            localStorage.setItem('loginAttempts', loginAttempts);
            localStorage.setItem('isBlocked', 'false');
            localStorage.setItem('blockedUntil', '0');
        }
        
        // Show notification
        function showNotification(title, message, type = 'info') {
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastTime = document.getElementById('toastTime');
            
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            toastTime.textContent = new Date().toLocaleTimeString();
            
            // Set background color based on type
            const toastElement = document.querySelector('.notification-toast');
            toastElement.classList.remove('bg-primary', 'bg-success', 'bg-danger', 'bg-warning');
            
            switch(type) {
                case 'success':
                    toastElement.classList.add('bg-success');
                    break;
                case 'error':
                    toastElement.classList.add('bg-danger');
                    break;
                case 'warning':
                    toastElement.classList.add('bg-warning');
                    break;
                default:
                    toastElement.classList.add('bg-primary');
            }
            
            toast.show();
        }
        
        // Initialize the application
        function initApp() {
            // Update dashboard stats
            updateDashboardStats();
            
            // Load data table
            loadDataTable();
            
            // Update recent data
            updateRecentData();
            
            // Update system info
            updateSystemInfo();
            
            // Populate year options
            populateYearOptions();
            
            // Populate desa options
            populateDesaOptions();
        }
        
        // Populate year options (2020-2090)
        function populateYearOptions() {
            const startYear = 2020;
            const endYear = 2090;
            
            // Get all year select elements
            const yearSelects = [
                'tahunAnggaran', 'filterTahun', 'statTahun', 'reportYear', 'defaultTahun'
            ];
            
            yearSelects.forEach(selectId => {
                const selectElement = document.getElementById(selectId);
                if (selectElement) {
                    // Clear existing options except the first one
                    const firstOption = selectElement.options[0];
                    selectElement.innerHTML = '';
                    selectElement.appendChild(firstOption);
                    
                    // Add years from 2020 to 2090
                    for (let year = startYear; year <= endYear; year++) {
                        const option = document.createElement('option');
                        option.value = year;
                        option.textContent = year;
                        selectElement.appendChild(option);
                    }
                    
                    // Set current year as selected if it's tahunAnggaran
                    if (selectId === 'tahunAnggaran') {
                        const currentYear = new Date().getFullYear();
                        selectElement.value = currentYear;
                    }
                }
            });
        }
        
        // Populate desa options
        function populateDesaOptions() {
            const desaSelect = document.getElementById('desa');
            if (desaSelect) {
                // Clear existing options except the first one
                const firstOption = desaSelect.options[0];
                desaSelect.innerHTML = '';
                desaSelect.appendChild(firstOption);
                
                // Add all desa options
                desaList.forEach(desa => {
                    const option = document.createElement('option');
                    option.value = desa;
                    option.textContent = desa;
                    desaSelect.appendChild(option);
                });
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Logout button
            document.getElementById('logoutBtn').addEventListener('click', function() {
                localStorage.removeItem('isAuthenticated');
                showNotification('Berhasil keluar', 'Anda telah keluar dari aplikasi.', 'info');
                setTimeout(() => {
                    window.location.reload();
                }, 1500);
            });
            
            // Input form submission
            document.getElementById('inputForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleFormSubmit();
            });
            
            // Generate code button
            document.getElementById('generateCodeBtn').addEventListener('click', function() {
                const code = Math.random().toString(36).substring(2, 10).toUpperCase();
                document.getElementById('kodeValidasi').value = code;
            });
            
            // Kecamatan change event
            document.getElementById('kecamatan').addEventListener('change', function() {
                const kecamatan = this.value;
                const desaSelect = document.getElementById('desa');
                
                // Clear existing options
                desaSelect.innerHTML = '<option value="">Pilih Desa</option>';
                
                // Add desa options based on kecamatan
                if (kecamatan) {
                    // Add all desa options
                    desaList.forEach(desa => {
                        const option = document.createElement('option');
                        option.value = desa;
                        option.textContent = desa;
                        desaSelect.appendChild(option);
                    });
                }
            });
            
            // Apply filter button
            document.getElementById('applyFilterBtn').addEventListener('click', function() {
                loadDataTable();
            });
            
            // Reset filter button
            document.getElementById('resetFilterBtn').addEventListener('click', function() {
                document.getElementById('filterTahun').value = 'all';
                document.getElementById('filterKecamatan').value = 'all';
                document.getElementById('filterJenis').value = 'all';
                document.getElementById('searchInput').value = '';
                loadDataTable();
            });
            
            // Clear search button
            document.getElementById('clearSearchBtn').addEventListener('click', function() {
                document.getElementById('searchInput').value = '';
                loadDataTable();
            });
            
            // Export buttons
            document.getElementById('exportExcelBtn').addEventListener('click', function() {
                exportToExcel();
            });
            
            document.getElementById('exportPdfBtn').addEventListener('click', function() {
                exportToPDF();
            });
            
            document.getElementById('printDataBtn').addEventListener('click', function() {
                window.print();
            });
            
            // FAB button
            document.getElementById('fabButton').addEventListener('click', function() {
                // Switch to input tab
                const inputTab = document.getElementById('v-pills-input-tab');
                bootstrap.Tab.getInstance(inputTab).show();
                
                // Scroll to top
                window.scrollTo(0, 0);
            });
            
            // Skip welcome countdown
            document.getElementById('skipCountdownBtn').addEventListener('click', function() {
                welcomeModal.hide();
            });
        }
        
        // Update dashboard statistics
        function updateDashboardStats() {
            document.getElementById('totalPenerima').textContent = bantuanData.length;
            
            const totalBantuan = bantuanData.reduce((sum, item) => sum + item.jumlahBantuan, 0);
            document.getElementById('totalBantuan').textContent = totalBantuan.toLocaleString('id-ID');
            
            // Count unique kecamatan
            const uniqueKecamatan = new Set(bantuanData.map(item => item.kecamatan));
            document.getElementById('totalKecamatan').textContent = uniqueKecamatan.size;
            
            // Find the most recent year
            const years = bantuanData.map(item => item.tahunAnggaran);
            const mostRecentYear = years.length > 0 ? Math.max(...years) : new Date().getFullYear();
            document.getElementById('tahunAktif').textContent = mostRecentYear;
        }
        
        // Load data table with filtering and pagination
        function loadDataTable() {
            const tableBody = document.getElementById('dataTableBody');
            const filterTahun = document.getElementById('filterTahun').value;
            const filterKecamatan = document.getElementById('filterKecamatan').value;
            const filterJenis = document.getElementById('filterJenis').value;
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            
            // Filter data
            let filteredData = bantuanData.filter(item => {
                let match = true;
                
                if (filterTahun !== 'all' && item.tahunAnggaran != filterTahun) {
                    match = false;
                }
                
                if (filterKecamatan !== 'all' && item.kecamatan !== filterKecamatan) {
                    match = false;
                }
                
                if (filterJenis !== 'all' && item.jenisBantuan !== filterJenis) {
                    match = false;
                }
                
                if (searchInput && !item.nama.toLowerCase().includes(searchInput) && 
                    !item.nik.includes(searchInput) && !item.whatsapp.includes(searchInput)) {
                    match = false;
                }
                
                return match;
            });
            
            // Sort by latest first
            filteredData.sort((a, b) => new Date(b.tanggalTerima) - new Date(a.tanggalTerima));
            
            // Update total records
            document.getElementById('totalRecords').textContent = `${filteredData.length} Data`;
            
            // Clear table body
            tableBody.innerHTML = '';
            
            if (filteredData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10" class="text-center">Tidak ada data</td></tr>';
                return;
            }
            
            // Populate table
            filteredData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.nama}</td>
                    <td>${item.nik}</td>
                    <td>${item.whatsapp}</td>
                    <td>${item.kecamatan}</td>
                    <td>${item.desa}</td>
                    <td>${item.jenisBantuan}</td>
                    <td>${item.jumlahBantuan} ${item.satuanBantuan}</td>
                    <td>${new Date(item.tanggalTerima).toLocaleDateString('id-ID')}</td>
                    <td>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-primary btn-view" data-id="${item.id}">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-warning btn-edit" data-id="${item.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger btn-delete" data-id="${item.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to action buttons
            addTableActionListeners();
        }
        
        // Add event listeners to table action buttons
        function addTableActionListeners() {
            // View buttons
            document.querySelectorAll('.btn-view').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    viewData(id);
                });
            });
            
            // Edit buttons
            document.querySelectorAll('.btn-edit').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editData(id);
                });
            });
            
            // Delete buttons
            document.querySelectorAll('.btn-delete').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteData(id);
                });
            });
        }
        
        // Handle form submission
        function handleFormSubmit() {
            // Get form values
            const nama = document.getElementById('nama').value;
            const nik = document.getElementById('nik').value;
            const whatsapp = document.getElementById('whatsapp').value;
            const namaKelompok = document.getElementById('namaKelompok').value;
            const jabatan = document.getElementById('jabatan').value;
            const tahunAnggaran = document.getElementById('tahunAnggaran').value;
            const kecamatan = document.getElementById('kecamatan').value;
            const desa = document.getElementById('desa').value;
            const alamat = document.getElementById('alamat').value;
            const jenisBantuan = document.getElementById('jenisBantuan').value;
            const namaBantuan = document.getElementById('namaBantuan').value;
            const jumlahBantuan = document.getElementById('jumlahBantuan').value;
            const satuanBantuan = document.getElementById('satuanBantuan').value;
            const tanggalTerima = document.getElementById('tanggalTerima').value;
            const namaPetugas = document.getElementById('namaPetugas').value;
            const driveLink = document.getElementById('driveLink').value;
            const kodeValidasi = document.getElementById('kodeValidasi').value;
            const keterangan = document.getElementById('keterangan').value;
            
            // Validate required fields
            if (!nama || !nik || !whatsapp || !tahunAnggaran || !kecamatan || !desa || 
                !jenisBantuan || !jumlahBantuan || !satuanBantuan || !tanggalTerima || !kodeValidasi) {
                showNotification('Error', 'Harap isi semua field yang wajib diisi', 'error');
                return;
            }
            
            // Validate NIK (must be 16 digits)
            if (nik.length !== 16 || !/^\d+$/.test(nik)) {
                document.getElementById('nikError').style.display = 'block';
                document.getElementById('nik').classList.add('input-error');
                showNotification('Error', 'NIK harus 16 digit angka', 'error');
                return;
            }
            
            // Create new data object
            const newData = {
                id: Date.now(), // Unique ID based on timestamp
                nama,
                nik,
                whatsapp,
                namaKelompok: namaKelompok || '-',
                jabatan,
                tahunAnggaran,
                kecamatan,
                desa,
                alamat: alamat || '-',
                jenisBantuan,
                namaBantuan: namaBantuan || '-',
                jumlahBantuan: parseInt(jumlahBantuan),
                satuanBantuan,
                tanggalTerima,
                namaPetugas: namaPetugas || '-',
                driveLink: driveLink || '-',
                kodeValidasi,
                keterangan: keterangan || '-',
                tanggalInput: new Date().toISOString()
            };
            
            // Add to data array
            bantuanData.push(newData);
            
            // Save to localStorage
            localStorage.setItem('bantuanData', JSON.stringify(bantuanData));
            
            // Show success message
            showNotification('Sukses', 'Data berhasil disimpan', 'success');
            
            // Reset form
            document.getElementById('inputForm').reset();
            
            // Update UI
            updateDashboardStats();
            loadDataTable();
            updateRecentData();
            updateSystemInfo();
        }
        
        // View data details
        function viewData(id) {
            const data = bantuanData.find(item => item.id == id);
            
            if (data) {
                // Create modal content
                const modalContent = `
                    <div class="modal-header">
                        <h5 class="modal-title">Detail Data Bantuan</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>Nama:</strong> ${data.nama}</p>
                                <p><strong>NIK:</strong> ${data.nik}</p>
                                <p><strong>WhatsApp:</strong> ${data.whatsapp}</p>
                                <p><strong>Nama Kelompok:</strong> ${data.namaKelompok}</p>
                                <p><strong>Jabatan:</strong> ${data.jabatan}</p>
                                <p><strong>Kecamatan:</strong> ${data.kecamatan}</p>
                                <p><strong>Desa:</strong> ${data.desa}</p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Alamat:</strong> ${data.alamat}</p>
                                <p><strong>Jenis Bantuan:</strong> ${data.jenisBantuan}</p>
                                <p><strong>Nama Bantuan:</strong> ${data.namaBantuan}</p>
                                <p><strong>Jumlah Bantuan:</strong> ${data.jumlahBantuan} ${data.satuanBantuan}</p>
                                <p><strong>Tanggal Terima:</strong> ${new Date(data.tanggalTerima).toLocaleDateString('id-ID')}</p>
                                <p><strong>Nama Petugas:</strong> ${data.namaPetugas}</p>
                                <p><strong>Kode Validasi:</strong> ${data.kodeValidasi}</p>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <p><strong>Keterangan:</strong> ${data.keterangan}</p>
                                ${data.driveLink !== '-' ? `<p><strong>Link Drive:</strong> <a href="${data.driveLink}" target="_blank">${data.driveLink}</a></p>` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    </div>
                `;
                
                // Create and show modal
                showModal('Detail Data', modalContent);
            }
        }
        
        // Edit data
        function editData(id) {
            const data = bantuanData.find(item => item.id == id);
            
            if (data) {
                // Create modal content with form
                const modalContent = `
                    <div class="modal-header">
                        <h5 class="modal-title">Edit Data Bantuan</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="editNama" class="form-label">Nama Lengkap</label>
                                        <input type="text" class="form-control" id="editNama" value="${data.nama}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editNik" class="form-label">NIK</label>
                                        <input type="text" class="formControl" id="editNik" value="${data.nik}" maxlength="16" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editWhatsapp" class="form-label">WhatsApp</label>
                                        <input type="text" class="form-control" id="editWhatsapp" value="${data.whatsapp}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editNamaKelompok" class="form-label">Nama Kelompok</label>
                                        <input type="text" class="form-control" id="editNamaKelompok" value="${data.namaKelompok}">
                                    </div>
                                    <div class="mb-3">
                                        <label for="editJabatan" class="form-label">Jabatan</label>
                                        <select class="form-select" id="editJabatan">
                                            <option value="Individu" ${data.jabatan === 'Individu' ? 'selected' : ''}>Individu</option>
                                            <option value="Ketua" ${data.jabatan === 'Ketua' ? 'selected' : ''}>Ketua</option>
                                            <option value="Sekretaris" ${data.jabatan === 'Sekretaris' ? 'selected' : ''}>Sekretaris</option>
                                            <option value="Bendahara" ${data.jabatan === 'Bendahara' ? 'selected' : ''}>Bendahara</option>
                                            <option value="Anggota" ${data.jabatan === 'Anggota' ? 'selected' : ''}>Anggota</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editTahunAnggaran" class="form-label">Tahun Anggaran</label>
                                        <select class="form-select" id="editTahunAnggaran" required>
                                            <!-- Options akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editKecamatan" class="form-label">Kecamatan</label>
                                        <select class="form-select" id="editKecamatan" required>
                                            <option value="">Pilih Kecamatan</option>
                                            <option value="Arjasa" ${data.kecamatan === 'Arjasa' ? 'selected' : ''}>Arjasa</option>
                                            <option value="Asembagus" ${data.kecamatan === 'Asembagus' ? 'selected' : ''}>Asembagus</option>
                                            <option value="Banyuglugur" ${data.kecamatan === 'Banyuglugur' ? 'selected' : ''}>Banyuglugur</option>
                                            <option value="Banyuputih" ${data.kecamatan === 'Banyuputih' ? 'selected' : ''}>Banyuputih</option>
                                            <option value="Besuki" ${data.kecamatan === 'Besuki' ? 'selected' : ''}>Besuki</option>
                                            <option value="Bungatan" ${data.kecamatan === 'Bungatan' ? 'selected' : ''}>Bungatan</option>
                                            <option value="Jangkar" ${data.kecamatan === 'Jangkar' ? 'selected' : ''}>Jangkar</option>
                                            <option value="Jatibanteng" ${data.kecamatan === 'Jatibanteng' ? 'selected' : ''}>Jatibanteng</option>
                                            <option value="Kapongan" ${data.kecamatan === 'Kapongan' ? 'selected' : ''}>Kapongan</option>
                                            <option value="Kendit" ${data.kecamatan === 'Kendit' ? 'selected' : ''}>Kendit</option>
                                            <option value="Mangaran" ${data.kecamatan === 'Mangaran' ? 'selected' : ''}>Mangaran</option>
                                            <option value="Mlandingan" ${data.kecamatan === 'Mlandingan' ? 'selected' : ''}>Mlandingan</option>
                                            <option value="Panarukan" ${data.kecamatan === 'Panarukan' ? 'selected' : ''}>Panarukan</option>
                                            <option value="Panji" ${data.kecamatan === 'Panji' ? 'selected' : ''}>Panji</option>
                                            <option value="Situbondo" ${data.kecamatan === 'Situbondo' ? 'selected' : ''}>Situbondo</option>
                                            <option value="Suboh" ${data.kecamatan === 'Suboh' ? 'selected' : ''}>Suboh</option>
                                            <option value="Sumbermalang" ${data.kecamatan === 'Sumbermalang' ? 'selected' : ''}>Sumbermalang</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="editDesa" class="form-label">Desa</label>
                                        <select class="form-select" id="editDesa" required>
                                            <option value="">Pilih Desa</option>
                                            <!-- Options akan diisi secara dinamis -->
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editAlamat" class="form-label">Alamat</label>
                                        <textarea class="form-control" id="editAlamat" rows="2">${data.alamat}</textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editJenisBantuan" class="form-label">Jenis Bantuan</label>
                                        <select class="form-select" id="editJenisBantuan" required>
                                            <option value="">Pilih Jenis Bantuan</option>
                                            <option value="Tunai" ${data.jenisBantuan === 'Tunai' ? 'selected' : ''}>Tunai</option>
                                            <option value="Beras" ${data.jenisBantuan === 'Beras' ? 'selected' : ''}>Beras</option>
                                            <option value="Pupuk" ${data.jenisBantuan === 'Pupuk' ? 'selected' : ''}>Pupuk</option>
                                            <option value="Bibit" ${data.jenisBantuan === 'Bibit' ? 'selected' : ''}>Bibit</option>
                                            <option value="Peralatan" ${data.jenisBantuan === 'Peralatan' ? 'selected' : ''}>Peralatan</option>
                                            <option value="Lainnya" ${data.jenisBantuan === 'Lainnya' ? 'selected' : ''}>Lainnya</option>
                                        </select>
                                    </div>
                                                                        <div class="mb-3">
                                        <label for="editNamaBantuan" class="form-label">Nama Bantuan</label>
                                        <input type="text" class="form-control" id="editNamaBantuan" value="${data.namaBantuan}">
                                    </div>
                                    <div class="mb-3">
                                        <label for="editJumlahBantuan" class="form-label">Jumlah Bantuan</label>
                                        <input type="number" class="form-control" id="editJumlahBantuan" value="${data.jumlahBantuan}" min="1" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editSatuanBantuan" class="form-label">Satuan</label>
                                        <select class="form-select" id="editSatuanBantuan" required>
                                            <option value="">Pilih Satuan</option>
                                            <option value="Rupiah" ${data.satuanBantuan === 'Rupiah' ? 'selected' : ''}>Rupiah</option>
                                            <option value="Kg" ${data.satuanBantuan === 'Kg' ? 'selected' : ''}>Kilogram</option>
                                            <option value="Karung" ${data.satuanBantuan === 'Karung' ? 'selected' : ''}>Karung</option>
                                            <option value="Paket" ${data.satuanBantuan === 'Paket' ? 'selected' : ''}>Paket</option>
                                            <option value="Unit" ${data.satuanBantuan === 'Unit' ? 'selected' : ''}>Unit</option>
                                            <option value="Lainnya" ${data.satuanBantuan === 'Lainnya' ? 'selected' : ''}>Lainnya</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editTanggalTerima" class="form-label">Tanggal Terima</label>
                                        <input type="date" class="form-control" id="editTanggalTerima" value="${data.tanggalTerima}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editNamaPetugas" class="form-label">Nama Petugas</label>
                                        <input type="text" class="form-control" id="editNamaPetugas" value="${data.namaPetugas}">
                                    </div>
                                    <div class="mb-3">
                                        <label for="editDriveLink" class="form-label">Link Drive</label>
                                        <input type="url" class="form-control" id="editDriveLink" value="${data.driveLink}">
                                    </div>
                                    <div class="mb-3">
                                        <label for="editKodeValidasi" class="form-label">Kode Validasi</label>
                                        <input type="text" class="form-control" id="editKodeValidasi" value="${data.kodeValidasi}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="editKeterangan" class="form-label">Keterangan</label>
                                        <textarea class="form-control" id="editKeterangan" rows="2">${data.keterangan}</textarea>
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" id="editId" value="${data.id}">
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <button type="button" class="btn btn-primary" id="saveEditBtn">Simpan Perubahan</button>
                    </div>
                `;
                
                // Create and show modal
                const editModal = showModal('Edit Data', modalContent);
                
                // Populate tahun anggaran options
                const tahunSelect = document.getElementById('editTahunAnggaran');
                const startYear = 2020;
                const endYear = 2090;
                
                for (let year = startYear; year <= endYear; year++) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    if (year == data.tahunAnggaran) {
                        option.selected = true;
                    }
                    tahunSelect.appendChild(option);
                }
                
                // Populate desa options
                const desaSelect = document.getElementById('editDesa');
                desaList.forEach(desa => {
                    const option = document.createElement('option');
                    option.value = desa;
                    option.textContent = desa;
                    if (desa === data.desa) {
                        option.selected = true;
                    }
                    desaSelect.appendChild(option);
                });
                
                // Add event listener for save button
                document.getElementById('saveEditBtn').addEventListener('click', function() {
                    saveEditedData(data.id);
                });
            }
        }
        
        // Save edited data
        function saveEditedData(id) {
            const dataIndex = bantuanData.findIndex(item => item.id == id);
            
            if (dataIndex !== -1) {
                // Get form values
                const nama = document.getElementById('editNama').value;
                const nik = document.getElementById('editNik').value;
                const whatsapp = document.getElementById('editWhatsapp').value;
                const namaKelompok = document.getElementById('editNamaKelompok').value;
                const jabatan = document.getElementById('editJabatan').value;
                const tahunAnggaran = document.getElementById('editTahunAnggaran').value;
                const kecamatan = document.getElementById('editKecamatan').value;
                const desa = document.getElementById('editDesa').value;
                const alamat = document.getElementById('editAlamat').value;
                const jenisBantuan = document.getElementById('editJenisBantuan').value;
                const namaBantuan = document.getElementById('editNamaBantuan').value;
                const jumlahBantuan = document.getElementById('editJumlahBantuan').value;
                const satuanBantuan = document.getElementById('editSatuanBantuan').value;
                const tanggalTerima = document.getElementById('editTanggalTerima').value;
                const namaPetugas = document.getElementById('editNamaPetugas').value;
                const driveLink = document.getElementById('editDriveLink').value;
                const kodeValidasi = document.getElementById('editKodeValidasi').value;
                const keterangan = document.getElementById('editKeterangan').value;
                
                // Validate required fields
                if (!nama || !nik || !whatsapp || !tahunAnggaran || !kecamatan || !desa || 
                    !jenisBantuan || !jumlahBantuan || !satuanBantuan || !tanggalTerima || !kodeValidasi) {
                    showNotification('Error', 'Harap isi semua field yang wajib diisi', 'error');
                    return;
                }
                
                // Update data
                bantuanData[dataIndex] = {
                    ...bantuanData[dataIndex],
                    nama,
                    nik,
                    whatsapp,
                    namaKelompok: namaKelompok || '-',
                    jabatan,
                    tahunAnggaran,
                    kecamatan,
                    desa,
                    alamat: alamat || '-',
                    jenisBantuan,
                    namaBantuan: namaBantuan || '-',
                    jumlahBantuan: parseInt(jumlahBantuan),
                    satuanBantuan,
                    tanggalTerima,
                    namaPetugas: namaPetugas || '-',
                    driveLink: driveLink || '-',
                    kodeValidasi,
                    keterangan: keterangan || '-',
                    tanggalUpdate: new Date().toISOString()
                };
                
                // Save to localStorage
                localStorage.setItem('bantuanData', JSON.stringify(bantuanData));
                
                // Close modal
                bootstrap.Modal.getInstance(document.querySelector('.modal')).hide();
                
                // Show success message
                showNotification('Sukses', 'Data berhasil diperbarui', 'success');
                
                // Update UI
                updateDashboardStats();
                loadDataTable();
                updateRecentData();
            }
        }
        
        // Delete data
        function deleteData(id) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                const dataIndex = bantuanData.findIndex(item => item.id == id);
                
                if (dataIndex !== -1) {
                    // Store deleted data for potential undo
                    const deletedData = bantuanData[dataIndex];
                    
                    // Remove from array
                    bantuanData.splice(dataIndex, 1);
                    
                    // Save to localStorage
                    localStorage.setItem('bantuanData', JSON.stringify(bantuanData));
                    
                    // Show success message with undo option
                    showNotificationWithUndo('Data dihapus', 'Data berhasil dihapus dari sistem', deletedData);
                    
                    // Update UI
                    updateDashboardStats();
                    loadDataTable();
                    updateRecentData();
                    updateSystemInfo();
                }
            }
        }
        
        // Show notification with undo option
        function showNotificationWithUndo(title, message, deletedData) {
            const toastElement = document.querySelector('.notification-toast');
            const toastBody = document.getElementById('toastMessage');
            
            toastBody.innerHTML = `
                ${message}
                <div class="mt-2">
                    <button class="btn btn-sm btn-undo" id="undoDeleteBtn">Batalkan</button>
                </div>
            `;
            
            // Set toast title and time
            document.getElementById('toastTitle').textContent = title;
            document.getElementById('toastTime').textContent = new Date().toLocaleTimeString();
            
            // Show toast
            toast.show();
            
            // Add event listener to undo button
            document.getElementById('undoDeleteBtn').addEventListener('click', function() {
                // Restore deleted data
                bantuanData.push(deletedData);
                
                // Save to localStorage
                localStorage.setItem('bantuanData', JSON.stringify(bantuanData));
                
                // Update UI
                updateDashboardStats();
                loadDataTable();
                updateRecentData();
                updateSystemInfo();
                
                // Show success message
                showNotification('Dibatalkan', 'Data berhasil dikembalikan', 'success');
                
                // Hide toast
                toast.hide();
            });
        }
        
        // Update recent data table
        function updateRecentData() {
            const tableBody = document.getElementById('recentDataTable');
            
            // Clear table body
            tableBody.innerHTML = '';
            
            if (bantuanData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" class="text-center">Tidak ada data</td></tr>';
                return;
            }
            
            // Get latest 5 records
            const recentData = [...bantuanData]
                .sort((a, b) => new Date(b.tanggalInput) - new Date(a.tanggalInput))
                .slice(0, 5);
            
            // Populate table
            recentData.forEach(item => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${item.nama}</td>
                    <td>${item.nik}</td>
                    <td>${item.whatsapp}</td>
                    <td>${item.jenisBantuan}</td>
                    <td>${item.jumlahBantuan} ${item.satuanBantuan}</td>
                    <td>${new Date(item.tanggalTerima).toLocaleDateString('id-ID')}</td>
                    <td>
                        <button class="btn btn-sm btn-primary btn-view" data-id="${item.id}">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to view buttons
            document.querySelectorAll('#recentDataTable .btn-view').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    viewData(id);
                });
            });
        }
        
        // Update system information
        function updateSystemInfo() {
            // Calculate database size
            const dataStr = JSON.stringify(bantuanData);
            const dataSize = new Blob([dataStr]).size;
            const dataSizeMB = (dataSize / (1024 * 1024)).toFixed(2);
            
            document.getElementById('dbSize').textContent = `${dataSizeMB} MB`;
            document.getElementById('totalDataSettings').textContent = bantuanData.length;
            
            // Browser info
            document.getElementById('browserInfo').textContent = navigator.userAgent;
            
            // LocalStorage status
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                document.getElementById('localStorageStatus').textContent = 'Supported';
            } catch (e) {
                document.getElementById('localStorageStatus').textContent = 'Not Supported';
            }
        }
        
        // Initialize charts
        function initCharts() {
            // Jenis Bantuan Chart
            const jenisBantuanCtx = document.getElementById('jenisBantuanChart').getContext('2d');
            const jenisBantuanChart = new Chart(jenisBantuanCtx, {
                type: 'pie',
                data: {
                    labels: ['Tunai', 'Beras', 'Pupuk', 'Bibit', 'Peralatan', 'Lainnya'],
                    datasets: [{
                        data: [0, 0, 0, 0, 0, 0],
                        backgroundColor: [
                            '#4e73df', '#1cc88a', '#36b9cc', '#f6c23e', '#e74a3b', '#858796'
                        ],
                        hoverBackgroundColor: [
                            '#2e59d9', '#17a673', '#2c9faf', '#dda20a', '#be2617', '#60616f'
                        ],
                        hoverBorderColor: "rgba(234, 236, 244, 1)",
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: "rgb(255,255,255)",
                            bodyColor: "#858796",
                            titleMarginBottom: 10,
                            titleColor: '#6e707e',
                            borderColor: '#dddfeb',
                            borderWidth: 1,
                            padding: 15,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw} data`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Tren Bantuan Chart
            const trenBantuanCtx = document.getElementById('trenBantuanChart').getContext('2d');
            const trenBantuanChart = new Chart(trenBantuanCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'],
                    datasets: [{
                        label: 'Jumlah Bantuan',
                        data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                        backgroundColor: 'rgba(78, 115, 223, 0.05)',
                        borderColor: 'rgba(78, 115, 223, 1)',
                        pointRadius: 3,
                        pointBackgroundColor: 'rgba(78, 115, 223, 1)',
                        pointBorderColor: 'rgba(78, 115, 223, 1)',
                        pointHoverRadius: 3,
                        pointHoverBackgroundColor: 'rgba(78, 115, 223, 1)',
                        pointHoverBorderColor: 'rgba(78, 115, 223, 1)',
                        pointHitRadius: 10,
                        pointBorderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            ticks: {
                                beginAtZero: true
                            },
                            grid: {
                                color: "rgb(234, 236, 244)",
                                drawBorder: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: "rgb(255,255,255)",
                            bodyColor: "#858796",
                            titleMarginBottom: 10,
                            titleColor: '#6e707e',
                            borderColor: '#dddfeb',
                            borderWidth: 1,
                            padding: 15,
                            displayColors: false
                        }
                    }
                }
            });
            
            // Update charts with data
            updateCharts(jenisBantuanChart, trenBantuanChart);
        }
        
        // Update charts with current data
        function updateCharts(jenisBantuanChart, trenBantuanChart) {
            // Update Jenis Bantuan Chart
            const jenisCount = {
                'Tunai': 0,
                'Beras': 0,
                'Pupuk': 0,
                'Bibit': 0,
                'Peralatan': 0,
                'Lainnya': 0
            };
            
            bantuanData.forEach(item => {
                if (jenisCount.hasOwnProperty(item.jenisBantuan)) {
                    jenisCount[item.jenisBantuan]++;
                }
            });
            
            jenisBantuanChart.data.datasets[0].data = [
                jenisCount['Tunai'],
                jenisCount['Beras'],
                jenisCount['Pupuk'],
                jenisCount['Bibit'],
                jenisCount['Peralatan'],
                jenisCount['Lainnya']
            ];
            jenisBantuanChart.update();
            
            // Update Tren Bantuan Chart
            const currentYear = new Date().getFullYear();
            const monthlyData = Array(12).fill(0);
            
            bantuanData.forEach(item => {
                const date = new Date(item.tanggalTerima);
                if (date.getFullYear() === currentYear) {
                    monthlyData[date.getMonth()]++;
                }
            });
            
            trenBantuanChart.data.datasets[0].data = monthlyData;
            trenBantuanChart.update();
        }
        
        // Export to Excel
        function exportToExcel() {
            // Create workbook and worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(bantuanData.map(item => ({
                'Nama': item.nama,
                'NIK': item.nik,
                'WhatsApp': item.whatsapp,
                'Kelompok': item.namaKelompok,
                'Jabatan': item.jabatan,
                'Tahun': item.tahunAnggaran,
                'Kecamatan': item.kecamatan,
                'Desa': item.desa,
                'Alamat': item.alamat,
                'Jenis Bantuan': item.jenisBantuan,
                'Nama Bantuan': item.namaBantuan,
                'Jumlah': item.jumlahBantuan,
                'Satuan': item.satuanBantuan,
                'Tanggal Terima': new Date(item.tanggalTerima).toLocaleDateString('id-ID'),
                'Petugas': item.namaPetugas,
                'Kode Validasi': item.kodeValidasi,
                'Keterangan': item.keterangan
            })));
            
            // Add worksheet to workbook
            XLSX.utils.book_append_sheet(wb, ws, 'Data Bantuan');
            
            // Generate Excel file and download
            XLSX.writeFile(wb, `Data_Bantuan_${new Date().toISOString().split('T')[0]}.xlsx`);
            
            // Show notification
            showNotification('Sukses', 'Data berhasil diekspor ke Excel', 'success');
        }
        
        // Export to PDF
        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add title
            doc.setFontSize(18);
            doc.text('LAPORAN DATA BANTUAN', 105, 15, { align: 'center' });
            doc.setFontSize(12);
            doc.text(`Tanggal: ${new Date().toLocaleDateString('id-ID')}`, 105, 22, { align: 'center' });
            
            // Add table
            doc.autoTable({
                head: [['Nama', 'NIK', 'Kecamatan', 'Jenis', 'Jumlah', 'Tanggal']],
                body: bantuanData.map(item => [
                    item.nama,
                    item.nik,
                    item.kecamatan,
                    item.jenisBantuan,
                    `${item.jumlahBantuan} ${item.satuanBantuan}`,
                    new Date(item.tanggalTerima).toLocaleDateString('id-ID')
                ]),
                startY: 30,
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [78, 115, 223] }
            });
            
            // Save PDF
            doc.save(`Laporan_Bantuan_${new Date().toISOString().split('T')[0]}.pdf`);
            
            // Show notification
            showNotification('Sukses', 'Data berhasil diekspor ke PDF', 'success');
        }
        
        // Show modal with custom content
        function showModal(title, content) {
            // Create modal element
            const modalDiv = document.createElement('div');
            modalDiv.className = 'modal fade';
            modalDiv.innerHTML = `
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        ${content}
                    </div>
                </div>
            `;
            
            // Add to document
            document.body.appendChild(modalDiv);
            
            // Create and show modal
            const modal = new bootstrap.Modal(modalDiv);
            modal.show();
            
            // Remove modal from DOM after hidden
            modalDiv.addEventListener('hidden.bs.modal', function() {
                document.body.removeChild(modalDiv);
            });
            
            return modal;
        }
        
        // Welcome modal countdown
        const countdownElement = document.getElementById('countdown');
        let countdownValue = 5;
        
        const countdownInterval = setInterval(() => {
            countdownValue--;
            countdownElement.textContent = countdownValue;
            
            if (countdownValue <= 0) {
                clearInterval(countdownInterval);
                welcomeModal.hide();
            }
        }, 1000);
    </script>
</body>
</html>
